
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Setup and Configuration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
<table id="doc-title" cellspacing="0" cellpadding="0">
  <tr>
  <td align="left" valign="top">
  <b>Setup and Configuration</b><br />
  </td>
  </tr>
</table>
<hr />

<table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
	<colgroup>
		<col width="12%"/>
		<col width="12%"/>
		<col width="*"/>
	</colgroup>
	<tr>
		<td align="left">
		<a href="install.html">
			<span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Previous</span>
		</a>
		</td>

		<td align="left">
		<a href="webprofileconfig.html">
			<span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Next</span>
		</a>
		</td>

		<td align="right">
		<a href="toc.html">
			<span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Contents</span>
		</a>
		</td>
	</tr>
</table>


<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><a id="GBFVV"></a><a id="setup-and-configuration"></a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_setup_and_configuration">5 Setup and Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to set up the Jakarta EE 8 CTS test suite and
configure it to work with your test environment. It is recommended that
you first set up the testing environment using the Jakarta EE 8 CI and then
with your Jakarta EE 8 server.</p>
</div>
<div class="paragraph">
<p>This chapter includes the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#GEWTL">Allowed Modifications</a></p>
</li>
<li>
<p><a href="#GEWTP">Configuring the Test Environment</a></p>
</li>
<li>
<p><a href="#GEWTQ">Configuring a Jakarta EE 8 Server</a></p>
</li>
<li>
<p><a href="#GEXPP">Modifying Environment Settings for Specific Technology
Tests</a></p>
</li>
<li>
<p><a href="#GEYPB">Using the JavaTest Harness Configuration GUI</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEWTL"></a><a id="allowed-modifications"></a></p>
</div>
<div class="sect2">
<h3 id="_5_1_allowed_modifications">5.1 Allowed Modifications</h3>
<div class="paragraph">
<p>You can modify the following test suite components only:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your implementation of the porting package</p>
</li>
<li>
<p><code>ts.jte</code> environment file</p>
</li>
<li>
<p>The vendor-specific SQL files in <code>&lt;TS_HOME&gt;/sql</code></p>
</li>
<li>
<p>Any files in <code>&lt;TS_HOME&gt;/bin</code> and <code>&lt;TS_HOME&gt;/bin/xml</code> (except for
<code>ts.*</code> files)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEWTP"></a><a id="configuring-the-test-environment"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_configuring_the_test_environment">5.2 Configuring the Test Environment</h3>
<div class="paragraph">
<p>The instructions in this section and in <a href="#GEWWA">Section 5.3.3,
"Configuring Your Application Server as the VI,"</a> step you through the
configuration process for the Solaris, Microsoft Windows, and Linux
platforms.</p>
</div>
<div class="paragraph">
<p>All CTS test configuration procedures are based on running the Ant
scripts against a set of build targets. The primary location of any
configuration settings you are likely to make is the
<code>&lt;TS_HOME&gt;/bin/ts.jte</code> environment file. You may also want to modify the
<code>javaee_vi.xml</code> and <code>initdb.xml</code> Ant configuration files and the
vendor-specific SQL files. These two files contain predefined Ant
targets that are implemented such that they automatically configure the
Jakarta EE 8 CI and its associated database in order to pass the CTS. A
Implementer may choose to implement these targets to work with their server
environment to perform the steps described in <a href="#GEWWA">Section 5.3.3,
"Configuring Your Application Server as the VI."</a></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Ant targets are available at all levels of the CTS source tree that
allow you to execute a wide variety of test scenarios and
configurations.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sthref15">Before You Begin</h3>
<div class="paragraph">
<p>In these instructions, variables in angle brackets need to be expanded
for each platform. For example, <code>&lt;TS_HOME&gt;</code> becomes <code>$TS_HOME</code> on
Solaris/Linux and <code>%TS_HOME%</code> on Windows. In addition, the forward
slashes (<code>/</code>) used in all of the examples need to be replaced with
backslashes (<code>\</code>) for Windows.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify the software pieces and assemble them into the Jakarta EE 8
platform to be tested for certification.</p>
</li>
<li>
<p>Implement the porting package APIs.<br>
Some functionality in the Jakarta EE 8 platform is not completely specified
by an API. To handle this situation, the Jakarta EE 8 CTS test suite
defines a set of interfaces in the <code>com.sun.cts.porting</code> package, which
serve to abstract any implementation-specific code. You must create your
own implementations of the porting package interfaces to work with your
particular Jakarta EE 8 server environment. See
<a href="portingpackage.html#GFAUG">Section 11.2, "Porting Package APIs,"</a> for
additional information about the porting APIs. API documentation for the
porting package interfaces is available in the <code>&lt;TS_HOME&gt;/docs/api</code>
directory.</p>
</li>
<li>
<p>Set up the Jakarta Platform, Enterprise Edition Compatible
Implementation (CI) server.<br>
See <a href="#GEWUI">Section 5.3.2, "Configuring the Jakarta EE 8 CI as the
VI,"</a> for a list of the modifications that must be made to run CTS
against the Jakarta EE 8 CI.</p>
</li>
<li>
<p>Set up the vendor&#8217;s Jakarta EE 8 server implementation (VI).<br>
See <a href="#GEWWA">Section 5.3.3, "Configuring Your Application Server as
the VI,"</a> for a list of the modifications that must be made to run CTS
against the vendor&#8217;s Jakarta EE 8 server.</p>
</li>
<li>
<p>Validate your configuration.<br>
Run the sample tests provided. If the tests pass, your basic
configuration is valid. See <a href="using.html#GFACS">Section 7.3,
"Validating Your Test Configuration,"</a> for information about using
JavaTest to run the sample tests.</p>
</li>
<li>
<p>Run the CTS tests.<br>
See <a href="using.html#GBFWO">Chapter 7, "Executing Tests,"</a> for information
about Starting JavaTest and running tests.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEWTQ"></a><a id="configuring-a-java-ee-8-server"></a></p>
</div>
</div>
<div class="sect2">
<h3 id="_5_3_configuring_a_jakarta_ee_8_server">5.3 Configuring a Jakarta EE 8 Server</h3>
<div class="paragraph">
<p>This section describes how to configure the Jakarta EE 8 server under test.
You can run the CTS tests against the Jakarta EE 8 CI or your own Jakarta
Platform, Enterprise Edition server. When performing interoperability
(interop) tests or web service-based tests, you will be running two Jakarta
EE 8 CI servers, one of which must be a Jakarta EE 8 CI using, or configured to
use a database. For example, Eclipse GlassFish 5.1 is bundled and configured to use
the Apache Derby database.</p>
</div>
<div class="paragraph">
<p>For the purposes of this section, it is useful to clarify three terms as
they are used here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Compatible Implementation (CI): Jakarta EE 8 CI, for example, Eclipse GlassFish 5.1</p>
</li>
<li>
<p>Vendor Implemention (VI): Jakarta EE 8 implementation from a vendor other
than Eclipse; typically, the goal of running the CTS is to certify a Jakarta
EE 8 VI; in some cases, for purposes of familiarizing yourself with CTS,
you may choose to run the Jakarta EE 8 CI as the VI</p>
</li>
<li>
<p>Bundled Derby: Apache Derby database bundled with the Jakarta EE 8 CI, Eclipse GlassFish 5.1</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEWSQ"></a><a id="java-platform-enterprise-edition-server-configuration-scenarios"></a></p>
</div>
<div class="sect3">
<h4 id="_5_3_1_jakarta_platform_enterprise_edition_server_configuration_scenarios">5.3.1 Jakarta Platform, Enterprise Edition Server Configuration Scenarios</h4>
<div class="paragraph">
<p>There are three general scenarios for configuring Jakarta EE 8 servers for
Jakarta EE 8 CTS testing (Note: in the following images, Java EE refers to Jakarta EE.
RI should be replaced with CI for Compatible Implementation):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure the Jakarta EE 8 CI as the server under test<br>
<span class="image"><img src="img/serverpath-ri.png" alt="CI as Server Under Test"></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Use the Jakarta EE 8 CI as the Jakarta EE 8 VI; you may want to do this as a
sanity check to make sure you are comfortable with using the Jakarta EE 8
CTS against a known standard CI with certified sample applications
before proceeding with tests against your Jakarta EE 8 VI. See
<a href="#GEWUI">Section 5.3.2, "Configuring the Jakarta EE 8 CI as the VI,"</a>
for instructions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure your Jakarta EE 8 VI as Server Under Test<br>
<span class="image"><img src="img/serverpath-vi.png" alt="VI as Server Under Test"></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is the primary goal of using the Jakarta EE 8 CTS; you will eventually
need to configure the Jakarta EE 8 implementation you want to certify. See
<a href="#GEWWA">Section 5.3.3, "Configuring Your Application Server as the
VI,"</a> for instructions.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure two Jakarta EE 8 servers for the purpose of interop testing<br>
<span class="image"><img src="img/serverpath-interop.png" alt="Two Servers for Interop Testing"></span></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Rebuildable tests and Interop tests require that you configure two Jakarta
EE 8 servers on one or two machines. One server will be your Jakarta EE 8
VI running a database of your choice with JDBC 4.1-compliant drivers.
The second server must be the Jakarta EE 8 CI using the bundled Java DB
database. See <a href="#GEXMH">Section 5.3.4, "Configuring a Jakarta Platform,
Enterprise Edition CI and VI for Interop/Rebuildable Tests,"</a> for
instructions.</p>
</div>
<div class="paragraph">
<p>In terms of the Jakarta EE 8 CTS, all CTS configuration settings are made
in the <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file. When configuring a Jakarta EE 8 server,
the important thing is to make sure that the settings you use for your
server match those in the <code>ts.jte</code> file.</p>
</div>
<div class="paragraph">
<p>These configuration scenarios are described in the following sections.</p>
</div>
<div class="paragraph">
<p><a id="GEWUI"></a><a id="configuring-the-java-ee-8-ri-as-the-vi"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_3_2_configuring_the_jakarta_ee_8_ci_as_the_vi">5.3.2 Configuring the Jakarta EE 8 CI as the VI</h4>
<div class="paragraph">
<p>To configure the Jakarta EE 8 CI as the server under test (that is, to use
the Jakarta EE 8 CI as the VI) follow the steps listed below. In this
scenario, the goal is simply to test the Jakarta EE 8 CI against the CTS
for the purposes of familiarizing yourself with CTS test procedures. You
may also want to refer to the Quick Start guides included with the Jakarta
EE 8 CTS for similar instructions.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set server properties in your <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file to suit
your test environment.<br>
Be sure to set the following properties:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the <code>webServerHost</code> property to the name of the host on which
your Web server is running that is configured with the CI.<br>
The default setting is <code>localhost</code>.</p>
</li>
<li>
<p>Set the <code>webServerPort</code> property to the port number of the host on
which the Web server is running and configured with the CI.<br>
The default setting is <code>8001</code>.</p>
</li>
<li>
<p>Set the <code>wsgen.ant.classname</code> property to the Vendor&#8217;s
implementation class that mimics the CI Ant task that in turn calls the
<code>wsgen</code> Java-to-WSDL tool.<br>
The default setting is <code>com.sun.tools.ws.ant.WsGen</code>.</p>
</li>
<li>
<p>Set the <code>wsimport.ant.classname</code> property to the Vendor&#8217;s
implementation class that mimics the CI Ant task that in turn calls the
<code>wsimport</code> WSDL-to-Java tool.<br>
The default setting is <code>com.sun.tools.ws.ant.WsImport</code>.</p>
</li>
<li>
<p>Set the <code>porting.ts.url.class</code> property to your porting
implementation class that is used for obtaining URLs.<br>
The default setting for the CI porting implementation is
<code>com.sun.ts.lib.implementation.sun.common.SunRIURL</code>.</p>
</li>
<li>
<p>Set the database-related properties in the <code>&lt;TS_HOME&gt;/bin/ts.jte</code>
file.<br>
<a href="database-config.html#GFKMW">Section D.3, "Database Properties in
ts.jte,"</a> lists the names and descriptions for the database properties
you need to set.</p>
</li>
<li>
<p>Add the following JVM option to the <code>command.testExecuteAppClient</code>
property to enable the Security Manager in the application client
container:<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">-Djava.security.manager</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add this option to the list of other <code>-D JVM</code> options for this property.<br>
As mentioned previously, these settings can vary, but must match
whatever you used when setting up the Jakarta EE 8 CI server.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Install the Jakarta EE 8 CI and configure basic settings, as described
in <a href="install.html#GBFTP">Chapter 4, "Installation."</a></p>
</li>
<li>
<p>Start the Jakarta EE 8 CI application server.<br>
Refer to the application server documentation for complete instructions.</p>
</li>
<li>
<p>Enable the Security Manager.<br>
If you are using the Jakarta EE 8 CI, execute the following command from
the command line:<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asadmin create-jvm-options -Djava.security.manager</code></pre>
</div>
</div>
</li>
<li>
<p>Stop and restart your application server so it is running with the
Security Manager enabled.</p>
</li>
<li>
<p>Change to the <code>&lt;TS_HOME&gt;/bin</code> directory.</p>
</li>
<li>
<p>Start your backend database.<br>
If you are using Derby as your backend database, execute the
<code>start.javadb</code> Ant target:<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant -f xml/impl/glassfish/s1as.xml start.javadb</code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, refer to your backend database administration documentation
for information about starting your database server.</p>
</div>
</li>
<li>
<p>Initialize your backend database.<br>
If you are using Derby as your backend database, execute the
<code>init.derby</code> Ant target:<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant -f xml/init.xml init.derby</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are not using Derby as your backend database, refer to
<a href="database-config.html#GFAVUb">Appendix D, "Configuring Your Backend
Database."</a><br></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using MySQL or MS SQL Server as your backend database, see
<a href="#GJLGQ">Section 5.4.25, "Backend Database Setup,"</a> for additional
database setup instructions.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Run the configuration Ant target.<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant config.vi</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>By default, the <code>config.vi</code> Ant task configures the entire application
server. Sometimes you may not want or need to configure everything, such
as connector RAR files. If you are not performing connector-related
tests, you can avoid the deployment and configuration of RAR files by
using the Ant option <code>-Dskip.config.connector=true</code>. This will reduce
configuration times, the deployment of unneeded RAR files, and the
creation of unnecessary resources on the server under test. For example,
the following command will do this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant -Dskip.config.connector=true config.vi</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Build the special web services clients.<br>
The special webservices tests under the <code>webservices12/specialcases</code>
directory have prebuilt endpoints, but the clients are not prebuilt. The
clients will be built after the endpoints are first predeployed to the
application server under test.<br>
During the build, the clients import the WSDLs (by means of the Jakarta EE
<code>wsimport</code> and <code>wsgen</code> tools) from the predeployed webservices
endpoints. This process verifies that importing a WSDL from a
predeployed webservice endpoint works properly.<br>
To build the special webservices clients, the following command must be
executed:<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant build.special.webservices.clients</code></pre>
</div>
</div>
<div class="paragraph">
<p>This predeploys all the special webservices endpoints, builds all the
special webservices clients, and then undeploys the special webservices
endpoints. See <a href="portingpackage.html#GKLJO">Section 11.2.2, "Ant-Based
Deployment Interface,"</a> for more information about the Ant-based
deployment interface, including guidelines for creating your own
Ant-based deployment implementation.</p>
</div>
</li>
<li>
<p>Continue on to <a href="using.html#GBFWO">Chapter 7, "Executing Tests,"</a>
for instructions on running tests.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEWWA"></a><a id="configuring-your-application-server-as-the-vi"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_3_3_configuring_your_application_server_as_the_vi">5.3.3 Configuring Your Application Server as the VI</h4>
<div class="paragraph">
<p>To use a Jakarta EE 8 server other than the Jakarta EE 8 CI, follow the steps
below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set server properties in your <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file to suit
your test environment.<br>
Be sure to set the following properties:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the <code>webServerHost</code> property to the name of the host on which
your Web server is running that is configured with the CI.<br>
The default setting is <code>localhost</code>.</p>
</li>
<li>
<p>Set the <code>webServerPort</code> property to the port number of the host on
which the Web server is running and configured with the CI.<br>
The default setting is <code>8001</code>.</p>
</li>
<li>
<p>Set the <code>wsgen.ant.classname</code> property to the Vendor&#8217;s
implementation class that mimics the CI Ant task that in turn calls the
<code>wsgen</code> Java-to-WSDL tool.<br>
The default setting is <code>com.sun.tools.ws.ant.WsGen</code>.</p>
</li>
<li>
<p>Set the <code>wsimport.ant.classname</code> property to the Vendor&#8217;s
implementation class that mimics the CI Ant task that in turn calls the
<code>wsimport</code> WSDL-to-Java tool.<br>
The default setting is <code>com.sun.tools.ws.ant.WsImport</code>.</p>
</li>
<li>
<p>Set the <code>porting.ts.url.class</code> property to your porting
implementation class that is used for obtaining URLs.</p>
</li>
<li>
<p>Set the database-related properties in the <code>&lt;TS_HOME&gt;/bin/ts.jte</code>
file.<br>
<a href="database-config.html#GFKMW">Section D.3, "Database Properties in
ts.jte,"</a> lists the names and descriptions for the database properties
you need to set.</p>
</li>
<li>
<p>Add the following JVM option to the <code>command.testExecuteAppClient</code>
property to enable the Security Manager in the application client
container:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">-Djava.security.manager</code></pre>
</div>
</div>
<div class="paragraph">
<p>Add this option to the list of other -D JVM options for this property.<br>
These settings can vary, but must match whatever you used when setting
up your Jakarta Platform, Enterprise Edition server.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Install the Jakarta Platform, Enterprise Edition VI and configure basic
settings.<br>
If you want to configure your Jakarta Platform, Enterprise Edition server
using Ant configuration target similar to the target for the Jakarta EE 8
CI, as described in <a href="install.html#GBFTP">Chapter 4, "Installation,"</a>
you will need to modify the <code>&lt;TS_HOME&gt;/bin/xml/javaee_vi.xml</code> file to
implement the defined Ant targets for your application server. Then run:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant config.vi</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Ant configuration targets you implement, if any, may vary. Whichever
configuration method you choose, make sure that all configuration steps
in this procedure are completed as shown.</p>
</div>
</li>
<li>
<p>Enable the Security Manager and then stop and restart your
application server so it is running with the Security Manager enabled.</p>
</li>
<li>
<p>Provide alternate endpoint and WSDL URLs, if necessary.<br>
The <code>&lt;TS_HOME&gt;/bin</code> directory contains the following <code>.dat</code> files:</p>
<div class="ulist">
<ul>
<li>
<p><code>jaxrpc-url-props.dat</code></p>
</li>
<li>
<p><code>jaxws-url-props.dat</code></p>
</li>
<li>
<p><code>jws-url-props.dat</code></p>
</li>
<li>
<p><code>webservices12-url-props.dat</code></p>
<div class="paragraph">
<p>These files contain the webservice endpoint and WSDL URLs that the CTS
tests use when running against the CI. In the porting package used by
the CTS, the URLs are returned as is since this is the form that the CI
expects. You may need an alternate form of these URLs to run the CTS
tests in your environment. However, you MUST NOT modify the existing
<code>.dat</code> files, but instead make any necessary changes in your own porting
implementation class to transform the URLs appropriately for your
environment.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Install and configure a database for the server under test.</p>
</li>
<li>
<p>Start your database.</p>
</li>
<li>
<p>Initialize your database for CTS tests.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you choose to not implement the <code>javaee_vi.xml</code> targets, execute
the following command to specify the appropriate DML file:<br>
(Derby DB Example)</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant -Dtarget.dml.file=tssql.stmt \
-Ddml.file=javadb/javadb.dml.sql copy.dml.file</code></pre>
</div>
</div>
</li>
<li>
<p>Execute the following command to initialize your particular
database:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant -f &lt;TS_HOME&gt;/bin/xml/initdb.xml init.Database</code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, to initialize a Derby DB database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant -f &lt;TS_HOME&gt;/bin/xml/initdb.xml init.javadb</code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="database-config.html#GFAVUb">Appendix D, "Configuring Your
Backend Database,"</a> for detailed database configuration and
initialization instructions and a list of database-specific
initialization targets.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Start your Jakarta EE 8 server.</p>
</li>
<li>
<p><a id="BABDADHA"></a> Set up required users and passwords.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set up database users and passwords that are used for JDBC
connections.<br>
The Jakarta EE 8 CTS requires several user names, passwords, and
user-to-role mappings. These need to match those set in your <code>ts.jte</code>
file. By default, <code>user1</code>, <code>user2</code>, <code>user3, password1</code>, <code>password2</code>, and
<code>password3</code> are set to <code>cts1</code>.</p>
</li>
<li>
<p><a id="BABBHFAI"></a> Set up users and passwords for your Jakarta Platform, Enterprise Edition
server.<br>
For the purpose of running the CTS test suite, these should be set as
follows:</p>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 34%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">User</th>
<th class="tableblock halign-left valign-top">Password</th>
<th class="tableblock halign-left valign-top">Groups</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j2ee_vi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j2ee_vi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>staff</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javajoe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javajoe</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>guest</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j2ee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j2ee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>staff</code>, <code>mgr</code>, <code>asadmin</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j2ee_ri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>j2ee_ri</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>staff</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Note that adding the <code>asadmin</code> group is only necessary when running
against the Eclipse GlassFis 5.1 Jakarta EE 8 CI application server. It is required in this case
because the management Jakarta Enterprise Bean (MEjb) in the Jakarta EE 8 server is protected
with the <code>asadmin</code> group. Other appservers may or may not choose to
protect their MEjb. If necessary for your appserver implementation, you
should also add the group name with which your MEjb is protected.<br>
Also make sure the principal to role-mappings that are specified in the
runtime XML files (see <a href="csiv2logs.html#GEXUI">Section B.6.1, "The
security-role-mapping Element"</a>) are properly mapped in your
environment. Note that the principal-to-role mappings may vary for each
application.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Make sure that the appropriate JDBC 4.1-compliant database driver
class, any associated database driver native libraries, and the correct
database driver URL are available.</p>
</li>
<li>
<p>Configure your Jakarta Platform, Enterprise Edition server to use the
appropriate JDBC logical name (<code>jdbc/DB1</code>) when accessing your database
server.</p>
</li>
<li>
<p>Configure your Jakarta EE 8 server to use the appropriate logical name
(<code>jdbc/DBTimer</code>) when accessing your Jakarta Enterprise Beans timer.</p>
</li>
<li>
<p>Provide access to a JNDI lookup service.</p>
</li>
<li>
<p>Provide access to a Web server.</p>
</li>
<li>
<p>Provide access to a Jakarta Mail server that supports the SMTP protocol.</p>
</li>
<li>
<p>Execute the <code>add.interop.certs</code> Ant target.<br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This step installs server side certificates for interoperability
testing; that is, it installs the CI&#8217;s server certificate to VI and VI&#8217;s
server certificate into the CI. This step is necessary for mutual
authentication tests in which both the server and client authenticate to
each other.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><a id="BABEGCJH"></a> Install the client-side certificate in the <code>trustStore</code> on the Jakarta EE 8
server. See <a href="#GEXWW">CSIv2 Test Setup</a> for more information.<br>
Certificates are located <code>&lt;TS_HOME&gt;/bin/certificates</code>. Use the
certificate that suits your environment.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>cts_cert</code>: For importing the CTS client certificate into a
<code>truststore</code></p>
</li>
<li>
<p><code>clientcert.jks</code>: Used by the Java SE 8 runtime to identify the CTS
client&#8217;s identity</p>
</li>
<li>
<p><code>clientcert.p12</code>: Contains CTS client certificate in <code>pkcs12</code> format</p>
</li>
<li>
<p>Append the file <code>&lt;TS_HOME&gt;/bin/server_policy.append</code> to the Java
policy file or files on your Jakarta EE 8 server.<br>
This file contains the grant statements used by the test harness,
signature tests, and API tests.</p>
</li>
<li>
<p>Append the file <code>&lt;TS_HOME&gt;/bin/client_policy.append</code> to the
application client&#8217;s Java policy file, which is referenced in the
<code>TestExecuteAppClient</code> section of the <code>ts.jte</code> file.</p>
</li>
<li>
<p>Make the appropriate transaction interoperability setting on the
Jakarta EE 8 server and the server that is running the Jakarta EE 8 CI.<br>
See <a href="#GEXWW">Section 5.4.19, "CSIv2 Test Setup."</a></p>
</li>
<li>
<p>If necessary, refer to the sections later in this chapter for
additional configuration information you may require for your particular
test goals.<br>
For example, see <a href="#GEXWW">Section 5.4.19, "CSIv2 Test Setup,"</a> for
configuration settings required for CSIv2 tests.</p>
</li>
<li>
<p>Restart your Jakarta EE 8 server.</p>
</li>
<li>
<p>Build the special Web services clients.<br>
This step may be bypassed at this time if you are not going to
immediately run the tests under
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/webservices12</code>. However, you must return
to this configuration section and complete it in order to run these
tests.<br>
The special Web services tests under the <code>webservices12/specialcases</code>
directory have prebuilt endpoints, but the clients are not prebuilt. The
clients will be built after the endpoints are first predeployed to the
application server under test.<br>
During the build the clients import the WSDLs (by means of the Jakarta EE
<code>wsimport</code> and <code>wsgen</code> tools) from the predeployed Web services
endpoints. This process verifies that importing a WSDL from a
predeployed Web service endpoint works properly.</p>
</li>
<li>
<p>Install the Jakarta EE 8 CI.</p>
</li>
<li>
<p>Set the following properties in your <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file.<br>
The current values should be saved since they will be needed later in this step.</p>
<div class="ulist">
<ul>
<li>
<p>Set the <code>javaee.home.ri</code> property to the location where the Jakarta EE 8
CI is installed.</p>
</li>
<li>
<p>Set the <code>wsgen.ant.classname</code> property to the Jakarta EE 8 application
server Ant task that in turn calls the <code>wsimport</code> Java-to-WSDL tool. It
must be set to:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">com.sun.tools.ws.ant.WsGen</code></pre>
</div>
</div>
</li>
<li>
<p>Set the <code>wsgen.classpath</code> property to:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">${javaee.classes.ri}:${tools.jar}</code></pre>
</div>
</div>
</li>
<li>
<p>Set the <code>wsimport.ant.classname</code> property to the Jakarta EE 8 application
server Ant task that in turn calls the <code>wsimport</code> WSDL-to-Java tool.<br>
It must be set to <code>com.sun.tools.ws.ant.WsImport</code></p>
</li>
<li>
<p>Set the <code>wsimport.classpath</code> property to the following value:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">${javaee.classes.ri}:${tools.jar}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Build the special Web services clients by executing the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant build.special.webservices.clients</code></pre>
</div>
</div>
<div class="paragraph">
<p>This predeploys all the special Web services endpoints, builds all the
special webservices clients, and then undeploys the special webservices
endpoints. See <a href="portingpackage.html#GKLJO">Section 11.2.2, "Ant-Based
Deployment Interface,"</a> for more information about the Ant-based
deployment interface, including guidelines for creating your own
Ant-based deployment implementation.</p>
</div>
</li>
<li>
<p>Once this command completes successfully, the following <code>ts.jte</code>
properties must be set back to their previous values:</p>
<div class="ulist">
<ul>
<li>
<p><code>wsgen.ant.classname</code></p>
</li>
<li>
<p><code>wsgen.classpath</code></p>
</li>
<li>
<p><code>wsimport.ant.classname</code></p>
</li>
<li>
<p><code>wsimport.classpath</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>The following <code>webservices12-url-props.dat</code> properties must be set
back to their original values:</p>
<div class="ulist">
<ul>
<li>
<p><code>specialcases.defaultserviceref.wsdlloc</code></p>
</li>
<li>
<p><code>specialcases.nameattrserviceref.wsdlloc</code></p>
</li>
<li>
<p><code>specialcases.providerserviceref.wsdlloc</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Continue on to <a href="using.html#GBFWO">Chapter 7, "Executing Tests"</a>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEXMH"></a><a id="configuring-a-jakarta-platform-enterprise-edition-ci-and-vi-for-interoprebuildable-tests"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_3_4_configuring_a_jakarta_platform_enterprise_edition_ci_and_vi_for_interop_rebuildable_tests">5.3.4 Configuring a Jakarta Platform, Enterprise Edition CI and VI for Interop/Rebuildable Tests</h4>
<div class="paragraph">
<p>Use the following procedure to configure the Jakarta EE 8 CTS for
interoperability and rebuildable testing. Note that you must complete
all of the setup instructions in this section and all of the steps in
<a href="#GEXWW">Section 5.4.19, "CSIv2 Test Setup,"</a> before you run the
CSIv2 tests.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Install and configure basic settings for the Jakarta EE 8 VI and the
Jakarta EE 8 CI.<br>
These procedures are described earlier in this section. You can run the
Jakarta EE 8 servers on separate machines or on the same machine. If
running both servers on the same machine, be careful to avoid
conflicting properties (for example, port settings).</p>
</li>
<li>
<p>Make sure that the following properties have been set in the
<code>ts.jte</code> file:</p>
<div class="ulist">
<ul>
<li>
<p><code>create.cmp.tables=true</code></p>
</li>
<li>
<p><code>javaee.home=</code> Jakarta EE 8 VI installation directory (JAVAEE_HOME)</p>
</li>
<li>
<p>`javaee.home.ri= `Jakarta EE 8 CI installation directory</p>
</li>
<li>
<p><code>mailuser1=</code> valid email address</p>
</li>
<li>
<p><code>mailHost=</code> valid SMTP server</p>
</li>
<li>
<p><code>orb.host=</code> host where the Jakarta EE 8 VI naming server is running</p>
</li>
<li>
<p><code>orb.port=</code> port where the Jakarta EE 8 VI naming service is running</p>
</li>
<li>
<p><code>orb.host.ri=</code> host where the Jakarta EE 8 CI naming service is running</p>
</li>
<li>
<p><code>orb.port.ri=</code> port where the Jakarta EE 8 CI naming service is running</p>
</li>
<li>
<p><code>webServerHost=</code> host where the Jakarta EE 8 VI Web server is running</p>
</li>
<li>
<p><code>webServerPort=</code> port where the Jakarta EE 8 VI Web server is running</p>
</li>
<li>
<p><code>webServerHost.2=</code> host where the Jakarta EE 8 CI Web server is running</p>
</li>
<li>
<p><code>webServerPort.2=</code> port where the Jakarta EE 8 CI Web server is running</p>
</li>
<li>
<p><code>securedWebServicePort=</code> port where the Jakarta EE 8 secure web service is
running</p>
</li>
<li>
<p><code>securedWebServicePort.2=</code> port where the Jakarta EE 8 CI secure web
service is running</p>
</li>
<li>
<p><code>porting.ts.deploy2.class.1=</code> vendor-provided deployment porting class</p>
</li>
<li>
<p><code>porting.ts.login.class.1=</code> vendor-provided login porting class</p>
</li>
<li>
<p><code>porting.ts.jms.class.1=</code> vendor-provided JMS porting class</p>
</li>
<li>
<p><code>porting.ts.tsHttpsURLConnection.class.1=</code> vendor-provided
HttpsURLConnection-class</p>
</li>
<li>
<p><code>ri.log.file.location=</code> location to which CI log files will be written
and optionally stored, if the <code>harness.log.trace</code> flag is set to <code>true</code><br></p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>create.interop.tables.only=true</code> property does not exist in the
<code>ts.jte</code> file by default but can be added if needed for creating interop
tables.</p>
</div>
<div class="paragraph">
<p>For the Jakarta EE 8 CI, you must set <code>create.cmp.tables=true</code> when you set
<code>create.interop.tables.only=true</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>As a general rule, <code>ts.jte</code> properties ending with the suffix ".ri" are
CI server properties that rarely need to be changed. Properties ending
with the suffix ".vi" are VI server properties that are more likely to
require modifying.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Configure both Jakarta EE 8 servers.<br>
Change to the <code>&lt;TS_HOME&gt;/bin</code> directory and run the following Ant
targets:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant config.ri
ant config.vi</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have not implemented the <code>config.vi</code> Ant target for your Jakarta EE
8 server, perform the steps shown in <a href="#GEWWA">Section 5.3.3,
"Configuring Your Application Server as the VI."</a></p>
</div>
</li>
<li>
<p>Configure rebuildable tests, if applicable at this time.<br>
Jakarta EE 8 CTS Rebuildable Tests are located under
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/jaxws</code> and
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/jws</code>. Run this and then continue on to
<a href="using.html#GBFWO">Chapter 7, "Executing Tests,"</a> for instructions on
executing tests. If you would like to run tests under
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/interop</code>, continue to the next step.</p>
</li>
<li>
<p>Add <code>&lt;JAVAEE_HOME&gt;/glassfish/modules/ejb-container.jar</code> to your
application server&#8217;s <code>CLASSPATH</code>.<br>
This JAR file is part of the Jakarta Enterprise Beans interoperability architecture. It
contains implementations of the required system value classes.</p>
</li>
<li>
<p>Initialize the databases using the appropriate Ant targets.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the machine running the CI database and execute the
following commands:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant init.javadb</code></pre>
</div>
</div>
</li>
<li>
<p>Change the <code>create.interop.tables.only</code> to false in the
<code>&lt;TS_HOME&gt;/bin/ts.jte</code> file.</p>
</li>
<li>
<p>Log into the machine running the VI database and execute the
following command:<br></p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant init.database</code></pre>
</div>
</div>
<div class="paragraph">
<p>Refer to <a href="database-config.html#GFAVUb">Appendix D, "Configuring Your
Backend Database,"</a> for detailed database configuration and
initialization instructions and a list of database-specific
initialization targets.</p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Start the standalone deployment server in a separate shell on the
same host as the CTS harness.<br>
The default deployment porting implementation goes through a standalone
deployment server with a dedicated classpath. To start this standalone
server, change to the <code>&lt;TS_HOME&gt;/bin</code> directory and execute the
<code>start.auto.deployment.server</code> Ant task.<br>
The standalone server is basically an RMI server used to copy archives
to the CI server&#8217;s <code>autodeploy</code> directory. A separate VM is necessary to
avoid classloading conflicts that could occur when the VI server is also
a version of CI server.</p>
</li>
<li>
<p>If necessary, refer to the sections later in this chapter for
additional configuration information you may require for your particular
test goals.<br>
For example, see <a href="#GEXWW">Section 5.4.19, "CSIv2 Test Setup,"</a> for
configuration settings required for CSIv2 tests.</p>
</li>
<li>
<p>Continue on to <a href="using.html#GBFWO">Chapter 7, "Executing Tests,"</a>
for instructions on running tests.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEXPP"></a><a id="modifying-environment-settings-for-specific-technology-tests"></a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_5_4_modifying_environment_settings_for_specific_technology_tests">5.4 Modifying Environment Settings for Specific Technology Tests</h3>
<div class="paragraph">
<p>Before you can run any of the technology-specific Jakarta EE 8 CTS tests,
you must supply certain information that JavaTest needs to run the tests
in your particular environment. This information exists in the
<code>&lt;TS_HOME&gt;/bin/ts.jte</code> environment file. This file contains sets of
name/value pairs that are used by the tests. You need to assign a valid
value for your environment for all of the properties listed in the
sections that follow.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>This section only discusses a small subset of the properties you can
modify. Refer to the <code>ts.jte</code> file for information about the many other
properties you may want to modify for your particular test environment.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This section includes the following topics:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#GEXQT">Test Harness Setup</a></p>
</li>
<li>
<p><a href="#GEXOS">Windows-Specific Properties</a></p>
</li>
<li>
<p><a href="#GEXPE">Test Execution Command Setup</a></p>
</li>
<li>
<p><a href="#GEXPB">Jakarta Servlet Test Setup</a></p>
</li>
<li>
<p><a href="#CBDDGJFC">Jakarta WebSocket Test Setup</a></p>
</li>
<li>
<p><a href="#GEXON">JDBC Test Setup</a></p>
</li>
<li>
<p><a href="#GEXQQ">Standalone RMI/IIOP Server Test Setup</a></p>
</li>
<li>
<p><a href="#GEXOT">Jakarta Mail Test Setup</a></p>
</li>
<li>
<p><a href="#GEXPU">Jakarta XML Registry Test Setup</a></p>
</li>
<li>
<p><a href="#GJKPO">Jakarta RESTful Web Services Test Setup</a></p>
</li>
<li>
<p><a href="#GEXQP">Deployment Test Setup</a></p>
</li>
<li>
<p><a href="#GEXOF">Jakarta Connector Test Setup</a></p>
</li>
<li>
<p><a href="#GEXPV">XA Test Setup</a></p>
</li>
<li>
<p><a href="#GKKOJ">Jakarta Enterprise Beans 3.2 Test Setup</a></p>
</li>
<li>
<p><a href="#GEXOX">Jakarta Enterprise Beans Timer Test Setup</a></p>
</li>
<li>
<p><a href="#GEXQB">Entity Bean Container-Managed Persistence Test Setup for Jakarta Enterprise Beans V 1.1</a></p>
</li>
<li>
<p><a href="#GEXOL">Jakarta Persistence API Test Setup</a></p>
</li>
<li>
<p><a href="#GEXPT">Jakarta Messaging Test Setup</a></p>
</li>
<li>
<p><a href="#GKWVB">Jakarta Authentication Test Setup</a></p>
</li>
<li>
<p><a href="#GEXWW">CSIv2 Test Setup</a></p>
</li>
<li>
<p><a href="#GEYBI">Jakarta Authorization Test Setup</a></p>
</li>
<li>
<p><a href="#GEYAM">WSDL: Webservice Test and Runtime Notes</a></p>
</li>
<li>
<p><a href="#CEGCHDEA">Jakarta Security API Test Setup</a></p>
</li>
<li>
<p><a href="#GEYNX">Signature Test Setup</a></p>
</li>
<li>
<p><a href="#GJLGQ">Backend Database Setup</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEXQT"></a><a id="test-harness-setup"></a></p>
</div>
<div class="sect3">
<h4 id="_5_4_1_test_harness_setup">5.4.1 Test Harness Setup</h4>
<div class="paragraph">
<p>Verify that the following properties, which are used by the test
harness, have been set in the <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">harness.temp.directory=&lt;TS_HOME&gt;/tmp
harness.log.port=2000
harness.log.traceflag=[true | false]
deployment_host.1=&lt;hostname&gt;
deployment_host.2=&lt;hostname&gt;
porting.ts.deploy2.class.1=&lt;vendor-deployment-class&gt;
porting.ts.login.class.1=&lt;vendor-login-class&gt;
porting.ts.url.class.1=&lt;vendor-url-class&gt;
porting.ts.jms.class.1=&lt;vendor-jms-class&gt;
porting.ts.tsHttpsURLConnection.class.1=&lt;vendor-HttpsURLConnection-class&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>harness.temp.directory</code> property specifies a temporary directory
that the harness creates and to which the CTS harness and tests write
temporary files. The default setting should not need to be changed.</p>
</li>
<li>
<p>The <code>harness.log.port</code> property specifies the port that server
components of the tests use to send logging output back to JavaTest. If
the default port is not available on the machine running JavaTest, you
must edit this property and set it to an available port. The default
setting is <code>2000</code>.</p>
</li>
<li>
<p>The <code>harness.log.traceflag</code> property is used to turn on or turn off
verbose debugging output for the tests. The value of the property is set
to <code>false</code> by default. Set the property to <code>true</code> to turn debugging on.</p>
</li>
<li>
<p>The <code>deployment_host.1</code> and <code>deployment_host.2</code> properties specify the
systems where the vendor&#8217;s Jakarta Platform, Enterprise Edition server and
the Jakarta Platform, Enterprise Edition CI server are running. By default,
JavaTest will use the <code>orb.host</code> and <code>orb.host.ri</code> systems, which are
set in the <code>ts.jte</code> file.</p>
</li>
<li>
<p>The porting class <code>.1</code> and <code>.2</code> property sets specify the class names
of porting class implementations. By default, both property sets point
to the Jakarta Platform, Enterprise Edition CI-specific classes. To run the
interoperability tests, do not modify the <code>.2</code> set. These properties
should always point to the Jakarta Platform, Enterprise Edition CI classes.
Modify the <code>.1</code> set to point to implementations that work in your
specific Jakarta Platform, Enterprise Edition environment. See
<a href="#GEXMH">Configuring a Jakarta Platform, Enterprise Edition CI and VI
for Interop/Rebuildable Tests</a> for additional information about setting
these properties.</p>
</li>
<li>
<p>The <code>-Dcts.tmp</code> option for the <code>testExecute</code> and
<code>testExecuteAppClient</code> commands in the <code>ts.jte</code> file have been set. This
Java option tells the test suite the location to which the test suite
will write temporary files.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEXOS"></a><a id="windows-specific-properties"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_2_windows_specific_properties">5.4.2 Windows-Specific Properties</h4>
<div class="paragraph">
<p>When configuring the Jakarta EE 8 CTS for the Windows environment, set the
following properties in <code>&lt;TS_HOME&gt;/bin/ts.jte</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pathsep</code> to semicolon (pathsep=<code>;</code>)</p>
</li>
<li>
<p><code>s1as.applicationRoot</code> to the drive on which you have installed CTS
(for example, <code>s1as.applicationRoot=C:</code>)<br>
When installing in the Windows environment, the Jakarta Platform,
Enterprise Edition CI, JDK, and CTS should all be installed on the same
drive. If you must install these components on different drives, also
change the <code>ri.applicationRoot</code> property in addition to the <code>pathsep</code>
and <code>s1as.applicationRoot</code> properties; for example:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>ri.applicationRoot=C:</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When configuring the CI and CTS for the Windows environment, never
specify drive letters in any path properties in <code>ts.jte</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEXPE"></a><a id="test-execution-command-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_3_test_execution_command_setup">5.4.3 Test Execution Command Setup</h4>
<div class="paragraph">
<p>The test execution command properties are used by the test harness. By
default, the <code>ts.jte</code> file defines a single command line for each of the
commands that is used for both UNIX and Windows environments.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>command.testExecute</code></p>
</li>
<li>
<p><code>command.testExecuteAppClient</code></p>
</li>
<li>
<p><code>command.testExecuteAppClient2</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If these commands do not meet your needs, you can define separate
entries for the UNIX and Windows environments. Edit either the <code>ts_unix</code>
or <code>ts_win32</code> test execution properties in the <code>ts.jte</code> file. For UNIX,
these properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>env.ts_unix.command.testExecute</code></p>
</li>
<li>
<p><code>env.ts_unix.command.testExecuteAppClient</code></p>
</li>
<li>
<p><code>env.ts_unix.command.testExecuteAppClient2</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For Windows, these properties are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>env.ts_win32.command.testExecute</code></p>
</li>
<li>
<p><code>env.ts_win32.command.testExecuteAppClient</code></p>
</li>
<li>
<p><code>env.ts_win32.command.testExecuteAppClient2</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>testExecute</code> property specifies the Java command that is used to
execute individual tests from a standalone URL client. Tests in which
the client directly invokes a web component (Jakarta Servlet or Jakarta Server Pages), use this
command line since there is no application client container involved.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The default settings are specific to the Jakarta Platform, Enterprise
Edition CI. If you are not using the Jakarta Platform, Enterprise Edition
CI, adjust these properties accordingly.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEXPB"></a><a id="jakarta-servlet-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_4_jakarta_servlet_test_setup">5.4.4 Jakarta Servlet Test Setup</h4>
<div class="paragraph">
<p>Make sure that the following servlet properties have been set in the
<code>ts.jte</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ServletClientThreads=[2X size of default servlet instance pool]
servlet_waittime=[number_of_milliseconds]
servlet_async_wait=[number_of_seconds]
logical.hostname.servlet=server
s1as.java.endorsed.dirs=${endorsed.dirs}${pathsep}${ts.home}/endorsedlib</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ServletClientThreads</code> property configures the number of threads
used by the client for the <code>SingleThreadModel</code> servlet test. If your
container implementation supports pooling of <code>SingleThreadModel</code>
servlets, set the value of the <code>ServletClientThreads</code> property to twice
the value of the default servlet instance pool size. If your container
implementation only maintains a single instance of a
<code>ServletClientThreads</code> servlet, use the default value of <code>2</code>.</p>
</div>
<div class="paragraph">
<p>The <code>servlet_waittime</code> property specifies the amount of time, in
milliseconds, to wait between the time when the <code>HttpSession</code> is set to
expire on the server and when the <code>HttpSession</code> actually expires on the
client. This time is configurable to allow the servlet container enough
time to completely invalidate the <code>HttpSession</code>. The default value is 10
milliseconds.</p>
</div>
<div class="paragraph">
<p>The test <code>serverpush</code> in Jakarta Servlet 4.0, uses <code>httpclient</code>, a new library
in JDK9 which is backported to JDK8. There is a restriction on using
<code>httpclient</code> in JDK8 as the <code>httpclient</code> depends on
java.util.concurrent.flow which is a new class in JDK9. To run the test
on JDK8, use Java Endorsed Standards Override Mechanism and append the
<code>flow.jar</code> into bootstrap classpath. This is done by appending the
<code>&lt;TS_HOME&gt;/endorsedlib</code> directory to <code>s1as.java.endorsed.dirs</code> property
in <code>ts.jte</code>.</p>
</div>
<div class="paragraph">
<p>The <code>servlet_async_wait</code> property sets the duration of time in seconds
to wait between sending asynchronous messages. This property is used in
place to test non-interrupted IO, where two messages are sent in two
different batches and the receiving end will be read in a different read
cycle. This property sets the time to wait in seconds on the sending
side. The default is 4 seconds.</p>
</div>
<div class="paragraph">
<p>The <code>logical.hostname.servlet</code> property identifies the configuration
name of the logical host on which the <code>ServletContext</code> is deployed. This
used to identify the name of a logical host that processes Jakarta EE 8
requests. Jakarta EE 8 requests may be directed to a logical host using
various physical or virtual host names or addresses, and a message
processing runtime may be composed of multiple logical hosts. The
<code>logical.hostname.servlet</code> property is required to properly identify the
Jakarta EE 8 profile&#8217;s <code>AppContextId</code> hostname. This property is used by
the Jakarta EE 8 security tests as well as by the
<code>ServletContext.getVirtualServerName()</code> method. If a
<code>logical.hostname.servlet</code> does not exist, set this property to the
default hostname (for example, <code>webServerHost</code>). The default is
"server".</p>
</div>
<div class="paragraph">
<p><a id="CBDDGJFC"></a><a id="jakarta-websocket-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_5_jakarta_websocket_test_setup">5.4.5 Jakarta WebSocket Test Setup</h4>
<div class="paragraph">
<p>Make sure that the following WebSocket property has been set in the
<code>ts.jte</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ws_wait=[number_of_seconds]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ws_wait</code> property configures the wait time, in seconds, for the
socket to send or receive a message. A multiple of 5 of this time is
also used to test socket timeouts.</p>
</div>
<div class="paragraph">
<p>The Jakarta WebSocket tests also use the following properties: <code>webServerHost</code>
and <code>webServerPort</code>. See <a href="#GEWUI">Section 5.3.2, "Configuring the
Jakarta EE 8 CI as the VI,"</a> for more information about setting these
properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The SSL related tests under
<code>/ts/javaeetck/src/com/sun/ts/tests/websocket/platform/javax/websocket/server/handshakerequest/authenticatedssl/</code>
use self signed certificate bundled with the CTS bundle. These
certificates are generated with localhost as the hostname and would work
only when orb.host value is set to localhost in ts.jte. If the server&#8217;s
hostname is used instead of the localhost, the tests in this suite might
fail with the below exception - javax.websocket.DeploymentException: SSL
handshake has failed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEXON"></a><a id="jdbc-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_6_jdbc_test_setup">5.4.6 JDBC Test Setup</h4>
<div class="paragraph">
<p>The JDBC tests require you to set the timezone by modifying the <code>tz</code>
property in the <code>ts.jte</code> file. On Solaris systems, you can check the
timezone setting by looking in the file <code>/etc/default/init</code>. Valid
values for the <code>tz</code> property are in the directory
<code>/usr/share/lib/zoneinfo</code>. The default setting is <code>US/Eastern</code>. This
setting is in <code>/usr/share/lib/zoneinfo/US</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>tz</code> property is only used for Solaris configurations; it does not
apply to Windows XP/2000.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEXQQ"></a><a id="standalone-rmiiiop-server-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_7_standalone_rmi_iiop_server_test_setup">5.4.7 Standalone RMI/IIOP Server Test Setup</h4>
<div class="paragraph">
<p>The standalone RMI/IIOP server testing verifies that Jakarta Platform,
Enterprise Edition application components can access and communicate
with an external RMI/IIOP server application.</p>
</div>
<div class="paragraph">
<p>The <code>start.rmiiiop.server</code> Ant target uses the <code>ts.classpath</code> property
setting from the <code>ts.jte</code> file when starting the standalone RMI/IIOP
server application. The standalone RMI/IIOP server application must
start up using the ORB that comes with the Jakarta Platform, Enterprise
Edition CI.</p>
</div>
<div class="paragraph">
<p>Make sure that <code>ts.classpath</code> property contains the Jakarta Platform,
Enterprise Edition CI JAR files and classes and that the following
properties have been set in the <code>ts.jte</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">rmi.http.server.host=[hostname]
rmi.http.server.port=[port-number]</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>rmi.http.server.host</code> and <code>rmi.http.server.port</code> properties must be
set to the host and port where the standalone RMI/IIOP http server is
running. The default values for these properties are <code>localhost</code> and
<code>10000</code>, respectively.</p>
</div>
<div class="paragraph">
<p>To start the standalone RMI/IIOP server, execute the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant start.rmiiiop.server</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEXOT"></a><a id="jakarta-mail-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_8_jakarta_mail_test_setup">5.4.8 Jakarta Mail Test Setup</h4>
<div class="paragraph">
<p>Complete the following tasks before you run the Jakarta Mail tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the following properties in the <code>ts.jte</code> file:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">mailuser1=[user@domain]
mailFrom=[user@domain]
mailHost=mailserver
javamail.password=password</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Set the <code>mailuser1</code> property to a valid mail address. Mail messages
generated by the Jakarta Mail tests are sent to the specified address. This
user must be created in the IMAP server.</p>
</li>
<li>
<p>Set the <code>mailFrom</code> property to a mail address from which mail messages
that the Jakarta Mail tests generate will be sent.</p>
</li>
<li>
<p>Set the <code>mailHost</code> property to the address of a valid mail server
where the mail will be sent.</p>
</li>
<li>
<p>Set the <code>javamail.password</code> property to the password for <code>mailuser1</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Populate your IMAP server with sample messages.<br>
Change to the <code>&lt;TS_HOME&gt;/bin</code> directory and execute the Ant target
<code>populateMailbox</code> to create the sample messages in your IMAP server.</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant populateMailbox</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJKPO"></a><a id="jakarta-restful-web-services-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_9_jakarta_restful_web_services_test_setup">5.4.9 Jakarta RESTful Web Services Test Setup</h4>
<div class="paragraph">
<p>This section explains how to set up the test environment to run the
Jakarta RESTful Web Services tests using the Jakarta EE 8 Compatible Implementation and/or a
Vendor Implementation. This setup also includes steps for
packaging/repackaging and publishing the packaged/repackaged WAR files
as well.</p>
</div>
<div class="paragraph">
<p><a id="GJYCL"></a><a id="to-configure-your-environment-to-run-the-jakarta-restful-web-services-tests-against-the-jakarta-ee-8-ci"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_9_1_to_configure_your_environment_to_run_the_jakarta_restful_web_services_tests_against_the_jakarta_ee_8_ci">5.4.9.1 To Configure Your Environment to Run the Jakarta RESTful Web Services Tests Against the Jakarta EE 8 CI</h5>
<div class="paragraph">
<p>Edit your <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file and set the following environment
variables:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the <code>jaxrs_impl_lib</code> property to point to the Jakarta RESTful Web Services CI.<br>
The default setting for this property is
<code>${javaee.home}/modules/jersey-container-servlet-core.jar</code> .</p>
</li>
<li>
<p>Set the <code>servlet_adaptor</code> property to point to the Servlet adapter
class for the Jakarta RESTful Web Services implementation.<br>
The default setting for this property is
<code>org/glassfish/jersey/servlet/ServletContainer.class</code>, the servlet
adaptor supplied in Jersey.</p>
</li>
<li>
<p>Set the <code>jaxrs_impl_name</code> property to the name of the Jakarta RESTful Web Services CI.<br>
The default setting for this property is <code>jersey</code>.<br>
An Ant script, jersey.xml, in the <code>&lt;TS_HOME&gt;/bin/xml/impl/glassfish</code>
directory contains packaging instructions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJYBC"></a><a id="to-package-war-files-for-deployment-on-the-jakarta-ee-8-ci"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_9_2_to_package_war_files_for_deployment_on_the_jakarta_ee_8_ci">5.4.9.2 To Package WAR files for Deployment on the Jakarta EE 8 CI</h5>
<div class="paragraph">
<p>The Jakarta EE 8 CTS test suite does not come with prebuilt test WAR files
for deployment on Jakarta EE 8 CI. The test suite includes a command to
generate the test WAR files that will be deployed on the Jakarta EE 8 CI.
The WAR files are Jersey-specific, with Jersey&#8217;s servlet class and
Eclipse Jersey&#8217;s servlet defined in the <code>web.xml</code> deployment descriptor.</p>
</div>
<div class="paragraph">
<p>To package the Jakarta RESTful Web Services WAR files for deployment on the Jakarta EE 8 CI,
complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change to the <code>&lt;TS_HOME&gt;/bin</code> directory.</p>
</li>
<li>
<p>Execute the <code>update.jaxrs.wars</code> Ant target.<br>
In a test WAR files that has the <code>servlet_adaptor</code> property defined,
this target replaces the <code>servlet_adaptor</code> value of the servlet class
name property in the <code>web.xml</code> file of the WAR files to be deployed on
the Jakarta EE 8 CI.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJYBR"></a><a id="to-configure-your-environment-to-run-the-jakarta-restful-web-services-tests-against-a-vendor-implementation"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_9_3_to_configure_your_environment_to_run_the_jakarta_restful_web_services_tests_against_a_vendor_implementation">5.4.9.3 To Configure Your Environment to Run the Jakarta RESTful Web Services Tests Against a Vendor Implementation</h5>
<div class="paragraph">
<p>Complete the following steps to configure your test environment to run
the Jakarta RESTful Web Services tests against your vendor implementation. Before you can run
the tests, you need to repackage the WAR files that contain the Jakarta RESTful Web Services
tests and the VI-specific Servlet class that will be deployed on the
vendor&#8217;s Jakarta EE 8-compliant application server.</p>
</div>
<div class="paragraph">
<p>Edit your <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file and set the following properties:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the <code>jaxrs_impl_lib</code> property to point to the JAR file that
contains the vendor&#8217;s Jakarta RESTful Web Services Servlet adapter implementation.<br>
The default setting for this property is
<code>${javaee.home}/modules/jersey-container-servlet-core.jar</code> .</p>
</li>
<li>
<p>Set the <code>servlet_adaptor</code> property to point to the Servlet adapter
class for the vendor&#8217;s Jakarta RESTful Web Services implementation.<br>
The class must be located in the JAR file defined by the
<code>jaxrs_impl_lib</code> property. By default, this property is set to
<code>org/glassfish/jersey/servlet/ServletContainer.class</code>, the servlet
adapter supplied in Jersey.</p>
</li>
<li>
<p>Set the <code>jaxrs_impl_name</code> property to the name of the Jakarta RESTful Web Services vendor
implementation to be tested.<br>
The name of the property must be unique. An Ant file bearing this name,
&lt;jaxrs_impl_name&gt;.xml, should be created under
<code>&lt;TS_HOME&gt;/bin/xml/impl/${impl.vi}</code> with packaging and/or deployment
instructions as described in <a href="#GJYDD">Section 5.4.9.4, "To Repackage
WAR files for Deployment on the Vendor Implementation."</a><br>
The default setting for this property is <code>jersey</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJYDD"></a><a id="to-repackage-war-files-for-deployment-on-the-vendor-implementation"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_9_4_to_repackage_war_files_for_deployment_on_the_vendor_implementation">5.4.9.4 To Repackage WAR files for Deployment on the Vendor Implementation</h5>
<div class="paragraph">
<p>To run the Jakarta RESTful Web Services tests against a vendor&#8217;s implementation in a Jakarta EE
8-compliant application server, the tests need to be repackaged to
include the VI-specific servlet, and the VI-specific servlet must be
defined in the deployment descriptor.</p>
</div>
<div class="paragraph">
<p>A vendor must create VI-specific Jakarta EE 8-compliant WAR files so the
VI-specific Servlet class will be included instead of the Jakarta EE 8
CI-specific Servlet class.</p>
</div>
<div class="paragraph">
<p>All resource and application class files are already compiled. The
Vendor needs to package these files. Jakarta EE 8 CTS makes this task
easier by including template WAR files that contain all of the necessary
files except for the VI-specific servlet adaptor class. The Jakarta EE 8
CTS also provides a tool to help with the repackaging task.</p>
</div>
<div class="paragraph">
<p>Each test that has a Jakarta RESTful Web Services resource class to publish comes with a
template deployment descriptor file. For example, the file
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/jaxrs/ee/rs/get/web.xml.template</code>
contains the following elements:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee \
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;CTSJAX-RSGET&lt;/servlet-name&gt;
        &lt;servlet-class&gt;servlet_adaptor&lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;javax.ws.rs.Application&lt;/param-name&gt;
            &lt;param-value&gt;com.sun.ts.tests.jaxrs.ee.rs.get.TSAppConfig&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;CTSJAX-RSGET&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
    &lt;session-config&gt;
        &lt;session-timeout&gt;30&lt;/session-timeout&gt;
    &lt;/session-config&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, the <code>&lt;servlet-class&gt;</code> element has a value of
<code>servlet_adaptor</code>, which is a placeholder for the
implementation-specific Servlet class. An Eclipse Jersey-specific deployment
descriptor also comes with the Jakarta EE 8 CI, Eclipse GlassFish 5.1, and has the values for the
<code>com.sun.jersey.spi.container.servlet.ServletContainer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" \
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" \
xsi:schemaLocation="http://java.sun.com/xml/ns/javaee \
http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;
   &lt;servlet&gt;
        &lt;servlet-name&gt;CTSJAX-RSGET&lt;/servlet-name&gt;
        &lt;servlet-class&gt;
        org.glassfish.jersey.servlet.ServletContainer
        &lt;/servlet-class&gt;
        &lt;init-param&gt;
            &lt;param-name&gt;javax.ws.rs.Application&lt;/param-name&gt;
            &lt;param-value&gt;com.sun.ts.tests.jaxrs.ee.rs.get.TSAppConfig&lt;/param-value&gt;
        &lt;/init-param&gt;
        &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
    &lt;/servlet&gt;
    &lt;servlet-mapping&gt;
        &lt;servlet-name&gt;CTSJAX-RSGET&lt;/servlet-name&gt;
        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/servlet-mapping&gt;
    &lt;session-config&gt;
        &lt;session-timeout&gt;30&lt;/session-timeout&gt;
        &lt;/session-config&gt;
&lt;/web-app&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jakarta EE 8 CTS test suite provides a tool,
<code>${ts.home}/bin/xml/impl/glassfish/jersey.xml</code>, for the Jakarta EE 8 CI
that you can use as a model to help you create your own VI-specific Web
test application.</p>
</div>
<div class="paragraph">
<p>The following steps explain how to create a VI-specific deployment
descriptor.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a VI handler file.<br>
Create a VI-specific handler file
<code>&lt;TS_HOME&gt;/bin/xml/impl/${impl.vi}/${jaxrs_impl_name}.xml</code> if one does
not already exist.<br>
Ensure that the <code>jaxrs_impl_name</code> property is set in the <code>ts.jte</code> file
and that its name is unique, to prevent another file with the same name
from being overwritten.</p>
</li>
<li>
<p>Set the <code>servlet_adaptor</code> property in the <code>ts.jte</code> file.<br>
This property will be used to set the value of the <code>&lt;servlet-class&gt;</code>
element in the deployment descriptor.</p>
</li>
<li>
<p>Create VI Ant tasks.<br>
Create a <code>update.jaxrs.wars</code> target in the VI handler file. Reference
this <code>update.jaxrs.wars</code> target in the <code>jersey.xml</code> file.<br>
This target will create a <code>web.xml.${jaxrs_impl_name}</code> for each test
that has a deployment descriptor template. The
<code>web.xml.${jaxrs_impl_name)</code> will contain the VI-specific Servlet class
name. It will also create the test WAR files will be created under the
<code>&lt;TS_HOME&gt;/dist</code> directory. For example:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd $TS_HOME/dist/com/sun/ts/tests/jaxrs/ee/rs/get/
ls jaxrs_rs_get_web.war.jersey
jaxrs_rs_get_web.war.${jaxrs_impl_name}</code></pre>
</div>
</div>
</li>
<li>
<p>Change to the <code>&lt;TS_HOME&gt;/bin</code> directory and execute the
<code>update.jaxrs.wars</code> Ant target.<br>
This creates a <code>web.xml.${jaxrs_impl_name}</code> file for each test based on
the VI&#8217;s servlet class name and repackages the tests.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEXOF"></a><a id="jakarta-connector-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_10_jakarta_connector_test_setup">5.4.10 Jakarta Connector Test Setup</h4>
<div class="paragraph">
<p>The Jakarta Connector tests verify that a Jakarta EE 8 server correctly implements
the Jakarta Connector V1.7 specification. The Connector compatibility tests
ensure that your Jakarta EE 8 server still supports the Connector V1.0
functionality.</p>
</div>
<div class="paragraph">
<p>The <code>config.vi</code> target is run to configure the Jakarta EE 8 server for
running Connector tests. The <code>config.vi</code> target calls the
<code>config.connecto`r target, which is defined in
`TS_HOME/bin/xml/impl/glassfish/s1as.xml</code>, to deploy the RAR files
listed in <a href="#GJVGT">Section 5.4.10.1, "Extension Libraries."</a> and
create the required connection resources and connection pools used for
the Connector tests. The <code>config.vi</code> target also performs several other
tasks, such as creating required users and security mappings, setting
appropriate JVM options, etc. that also are needed to run the Connector
tests.</p>
</div>
<div class="paragraph">
<p><a id="GJVGT"></a><a id="extension-libraries"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_10_1_extension_libraries">5.4.10.1 Extension Libraries</h5>
<div class="paragraph">
<p>The following Connector files are deployed as part of the <code>config.vi</code>
Ant target:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>whitebox-mixedmode.rar</code></p>
</li>
<li>
<p><code>whitebox-tx-param.rar</code></p>
</li>
<li>
<p><code>whitebox-multianno.rar</code></p>
</li>
<li>
<p><code>whitebox-tx.rar</code></p>
</li>
<li>
<p><code>whitebox-anno_no_md.rar</code></p>
</li>
<li>
<p><code>whitebox-notx-param.rar</code></p>
</li>
<li>
<p><code>whitebox-xa-param.rar</code></p>
</li>
<li>
<p><code>whitebox-mdcomplete.rar</code></p>
</li>
<li>
<p><code>whitebox-notx.rar</code></p>
</li>
<li>
<p><code>whitebox-xa.rar</code></p>
</li>
<li>
<p><code>old-dd-whitebox-notx-param.rar</code></p>
</li>
<li>
<p><code>old-dd-whitebox-xa-param.rar</code></p>
</li>
<li>
<p><code>old-dd-whitebox-tx.rar</code></p>
</li>
<li>
<p><code>old-dd-whitebox-notx.rar</code></p>
</li>
<li>
<p><code>old-dd-whitebox-xa.rar</code></p>
</li>
<li>
<p><code>old-dd-whitebox-tx-param.rar</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>RAR files with an <code>old</code> prefix are used to test the support of RAs that
are bundled with an older version of the <code>ra.xml</code> files.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The manifest file in each RAR file includes a reference to the whitebox
extension library. The <code>whitebox.jar</code> file is a Shared Library that must
be deployed as a separate entity that all the Jakarta Connector RAR files
access. This extension library is needed to address classloading issues.</p>
</div>
<div class="paragraph">
<p>The RAR files that are used with Jakarta EE 8 CTS test suite differ from
those that were used in earlier test suites. Jakarta EE 8 CTS no longer
bundles the same common classes into every RAR file. Duplicate common
classes have been removed and now exist in the <code>whitebox.jar</code> file, an
Installed Library that is deployed and is made available before any
other RAR files are deployed.</p>
</div>
<div class="paragraph">
<p>This was done to address the following compatibility issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Portable use of Installed Libraries for specifying a resource
adapter&#8217;s shared libraries<br>
See section EE.8.2.2 of the Jakarta EE 8 platform specification and section
20.2.0.1 in the Jakarta Connectors (formerly JCA) 1.7 specification, which explicitly state that the
resource adapter server may employ the library mechanisms in Jakarta EE 8.</p>
</li>
<li>
<p>Support application-based standalone connector accessibility<br>
Section 20.2.0.4 of the Jakarta Connectors (formerly JCA) 1.7 Specification uses the classloading
requirements that are listed in section 20.3 in the specification.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GJVGO"></a><a id="connector-resource-adapters-and-classloading"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_10_2_connector_resource_adapters_and_classloading">5.4.10.2 Connector Resource Adapters and Classloading</h5>
<div class="paragraph">
<p>Jakarta EE 8 CTS has scenarios in which multiple standalone RAR files that
use the same shared library (for example, <code>whitebox.jar</code>) are referenced
from an application component.</p>
</div>
<div class="paragraph">
<p>Each standalone RAR file gets loaded in its own classloader. Since the
application component refers to more than one standalone RAR file, all
of the referenced standalone RAR files need to be made available in the
classpath of the application component. In versions of the TCK prior to
Java EE 5, since each standalone RAR file contained a copy of the
<code>whitebox.jar</code> file, every time there was a reference to a class in the
<code>whitebox.jar</code> file from a standalone RAR, the reference was resolved by
using the private version of <code>whitebox.jar</code> (the <code>whitebox.jar</code> file was
bundled in each standalone RAR file). This approach can lead to class
type inconsistency issues.</p>
</div>
<div class="paragraph">
<p><a id="GJVHD"></a><a id="use-case-problem-scenario"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_10_3_use_case_problem_scenario">5.4.10.3 Use Case Problem Scenario</h5>
<div class="paragraph">
<p>Assume that RAR1 and RAR2 are standalone RAR files that are referred to
by an application, where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RAR1&#8217;s classloader has access to RAR1&#8217;s classes and its copy of
<code>whitebox.jar</code>. (RAR1&#8217;s classloader contains RAR1&#8217;s classes and
<code>whitebox.jar</code>)</p>
</li>
<li>
<p>RAR2&#8217;s classloader has access to RAR2&#8217;s classes and its copy of
<code>whitebox.jar</code>. (RAR2&#8217;s classloader contains RAR2&#8217;s classes and
<code>whitebox.jar</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the application refers to both of these RAR files, a classloader
that encompasses both of these classloaders (thereby creating a
classloader search order) is provided to the application. The
classloader search order could have the following sequence: ([RAR1&#8217;s
Classloader: RAR1&#8217;s classes and whitebox.jar], [RAR2&#8217;s Classloader:
RAR2&#8217;s classes and whitebox.jar]).</p>
</div>
<div class="paragraph">
<p>In this scenario, when an application loads a class (for example, class
<code>Foo</code>) in <code>whitebox.jar</code>, the application gets class <code>Foo</code> from RAR1&#8217;s
classloader because that is first in the classloader search order.
However, when this is cast to a class (for example, <code>Foo</code> or a subclass
of <code>Foo</code> or even a class that references <code>Foo</code>) that is obtained from
RAR2&#8217;s classloader (a sequence that is typically realized in a
<code>ConnectionFactory</code> lookup), this would result in a class-cast
exception.</p>
</div>
<div class="paragraph">
<p>The portable way of solving the issues raised by this use case problem
scenario is to use installed libraries, as described in section EE.8.2.2
in the Jakarta EE 8 platform specification. If both RAR files (RAR1 and
RAR2) reference <code>whitebox.jar</code> as an installed library and the
application server can use a single classloader to load this common
dependency, there will be no type-related issues.</p>
</div>
<div class="paragraph">
<p>In the CI Eclipse GlassFish 5.1, <code>domain-dir/lib/applibs</code> is used as the Installed Library
directory and is the location to which the <code>whitebox.jar</code> file gets
copied.</p>
</div>
<div class="paragraph">
<p><a id="GJVHK"></a><a id="required-porting-package"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_10_4_required_porting_package">5.4.10.4 Required Porting Package</h5>
<div class="paragraph">
<p>The Jakarta EE 8 CTS test suite treats the <code>whitebox.jar</code> dependency as an
Installed Library dependency instead of bundling the dependency (or
dependencies) with every RAR file. Each RAR file now contains a
reference to the <code>whitebox.jar</code> file through its Manifest files
Extension-List attribute.</p>
</div>
<div class="paragraph">
<p>It is necessary to identify the <code>whitebox.jar</code> to the connector server
as an installed library. The mechanism used to identify the
<code>whitebox.jar</code> file to the connector server as an Installed Library must
allow the Installed Libraries to have dependencies on Jakarta EE APIs. In
other words, because the <code>whitebox.jar</code> file depends on Jakarta EE APIs,
one cannot simply put the <code>whitebox.jar</code> file into a <code>java.ext.dir</code>
directory , which gets loaded by the VM extension classloader, because
that mechanism does not allow the <code>whitebox.jar</code> file to support its
dependencies on the Jakarta EE APIs. For this reason, the Installed Library
must support access to the Jakarta EE APIs.</p>
</div>
<div class="paragraph">
<p>See section EE.8.2.2 in the Jakarta EE 8 platform specification for
information about the compatible implementation&#8217;s support for Installed
libraries. However, note that this section does not recommend a
mechanism that a deployer can use to provide Installed Libraries in a
portable manner.</p>
</div>
<div class="paragraph">
<p><a id="GJVHH"></a><a id="creating-security-mappings-for-the-connector-rar-files"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_10_5_creating_security_mappings_for_the_connector_rar_files">5.4.10.5 Creating Security Mappings for the Connector RAR Files</h5>
<div class="paragraph">
<p>The Ant target <code>create.security.eis.mappings</code> in the
<code>&lt;TS_HOME&gt;/bin/xml/impl/glassfish/connector.xml</code> file maps Resource
Adapter user information to existing user information in the CI.</p>
</div>
<div class="paragraph">
<p>For the Eclipse GlassFish 5.1 CI, these mappings add a line to the <code>domain.xml</code> file, similar
to the one shown below, and should include 6 of these mappings:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;jvm-options&gt;-Dwhitebox-tx-map=cts1=j2ee&lt;/jvm-options&gt;
&lt;jvm-options&gt;-Dwhitebox-tx-param-map=cts1=j2ee&lt;/jvm-options&gt;
&lt;jvm-options&gt;-Dwhitebox-notx-map=cts1=j2ee&lt;/jvm-options&gt;
&lt;jvm-options&gt;-Dwhitebox-notx-param-map=cts1=j2ee&lt;/jvm-options&gt;
&lt;jvm-options&gt;-Dwhitebox-xa-map=cts1=j2ee&lt;/jvm-options&gt;
&lt;jvm-options&gt;-Dwhitebox-xa-param-map=cts1=j2ee&lt;/jvm-options&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>rauser1</code> property has been set to <code>cts1</code> and the <code>user</code> property
has been set to <code>j2ee</code> in the <code>ts.jte</code> file, the following mappings
would be required in the connector runtime:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For RA <code>whitebox-tx</code>, map <code>cts1</code> to <code>j2ee</code></p>
</li>
<li>
<p>For RA <code>whitebox-tx-param</code>, map <code>cts1</code> to <code>j2ee</code></p>
</li>
<li>
<p>For RA <code>whitebox-notx</code>, map <code>cts1</code> to <code>j2ee</code></p>
</li>
<li>
<p>For RA <code>whitebox-notx-param</code>, map <code>cts1</code> to <code>j2ee</code></p>
</li>
<li>
<p>For RA <code>whitebox-xa</code>, map <code>cts1</code> to <code>j2ee</code></p>
</li>
<li>
<p>For RA <code>whitebox-xa-param</code>, map <code>cts1</code> to <code>j2ee</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GJVGX"></a><a id="creating-required-server-side-jvm-options"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_10_6_creating_required_server_side_jvm_options">5.4.10.6 Creating Required Server-Side JVM Options</h5>
<div class="paragraph">
<p>Create the required JVM options that enable user information to be set
and/or passed from the <code>ts.jte</code> file to the server. The RAR files use
some of the property settings in the <code>ts.jte</code> file.</p>
</div>
<div class="paragraph">
<p>To see some of the required JVM options for the server under test, see
the <code>s1as.jvm.options</code> property in the <code>ts.jte</code> file. The connector
tests require that the following subset of JVM options be set in the
server under test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">-Dj2eelogin.name=j2ee
-Dj2eelogin.password=j2ee
-Deislogin.name=cts1
-Deislogin.password=cts1</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEXPV"></a><a id="xa-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_11_xa_test_setup">5.4.11 XA Test Setup</h4>
<div class="paragraph">
<p>The XA Test setup requires that the <code>ejb_Tsr.ear</code> file be deployed as
part of the <code>config.vi</code> Ant target. The <code>ejb_Tsr.ear</code> file contains an
embedded RAR file, which requires the creation of a connection-pool and
a connector resource.</p>
</div>
<div class="paragraph">
<p>For more details about the deployment of <code>ejb_Tsr.ear</code> and its
corresponding connection pool and connector resource values, see the
<code>setup.tsr.embedded.rar</code> Ant target in the
<code>&lt;TS_HOME&gt;/bin/xml/impl/glassfish/s1as.xml</code> file.</p>
</div>
<div class="paragraph">
<p>The XA tests reference some <code>JDBCWhitebox</code> name bindings that are
created as part of the <code>config.vi</code> target but those name bindings are
not tied to any JDBC RAR files. Instead, the following XA-specific
connection pool ids are referenced by the XA tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>eis/JDBCwhitebox-xa</code></p>
</li>
<li>
<p><code>eis/JDBCwhitebox-tx</code></p>
</li>
<li>
<p><code>eis/JDBCwhitebox-notx</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more details on these JDBC resources, examine the
<code>add.jdbc.resources</code> target in the same file to see the required JDBC
resources that are created. Both targets are called as part of the
<code>config.vi</code> target.</p>
</div>
<div class="paragraph">
<p>Complete the following steps (create JDBC connection pools and JDBC
resource elements, deploy the RAR files) to set up your environment to
run the XA tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a JDBC connection pool with the following attributes:</p>
<div class="ulist">
<ul>
<li>
<p>Set the resource type to <code>javax.sql.XADataSource</code></p>
</li>
<li>
<p>Set the datasourceclassname to
<code>org.apache.derby.jdbc.EmbeddedXADataSource</code></p>
</li>
<li>
<p>Set the property to
<code>DatabaseName=&lt;Derby-location&gt;:user=cts1:password=cts1</code></p>
</li>
<li>
<p>Set the connection pool name to <code>cts-derby-XA-pool</code><br>
For example, you could use the <code>asadmin</code> command line utility in the
Jakarta EE 8 CI, Eclipse GlassFish 5.1 to create this connection pool:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asadmin create-jdbc-connection-pool --restype javax.sql.XADataSource \
--datasourceclassname org.apache.derby.jdbc.EmbeddedXADataSource  \
--property 'DatabaseName=/tmp/DerbyDB:user=cts1:password=cts1' \
cts-derby-XA-pool</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <code>add.jdbc.pools</code> Ant target in the <code>s1as.xml</code> file for
additional information.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Create three JDBC connection pool elements (more specifically, the
JDBC connection pool elements) with the following JNDI names:</p>
<div class="ulist">
<ul>
<li>
<p>For the first connection pool element, set the connection pool id to
<code>cts-derby-XA-pool</code> and the JNDI name to <code>eis/JDBCwhitebox-xa</code></p>
</li>
<li>
<p>For the second connection pool element, set the connection pool id to
<code>cts-derby-XA-pool</code> and the JNDI name to <code>eis/JDBCwhitebox-tx</code></p>
</li>
<li>
<p>For the third connection pool element, set the connection pool id to
<code>cts-derby-XA-pool</code> and the JNDI name to <code>eis/JDBCwhitebox-notx</code><br>
For example, you could use the <code>asadmin</code> command line utility in the
Jakarta EE 8 CI to create the three connection pool elements:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asadmin  asadmin  create-jdbc-resource --connectionpoolid cts-derby-XA-pool \
 eis/JDBCwhitebox-xa
asadmin  create-jdbc-resource --connectionpoolid cts-derby-XA-pool \
 eis/JDBCwhitebox-tx
asadmin  create-jdbc-resource --connectionpoolid cts-derby-XA-pool \
 eis/JDBCwhitebox-notx</code></pre>
</div>
</div>
<div class="paragraph">
<p>If two or more JDBC resource elements point to the same connection pool
element, they use the same pool connection at runtime. Jakarta EE 8 CTS
does reuse the same connection pool ID for testing the Jakarta EE 8 CI Eclipse GlassFish 5.1.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Make sure that the following EIS and RAR files have been deployed
into your environment before you run the XA tests:</p>
<div class="ulist">
<ul>
<li>
<p>For the EIS resource adapter, deploy the following RAR files. Most of
these files are standalone RAR files, but there is also an embedded RAR
file that is contained in the <code>ejb_Tsr.ear</code> file. With the CI, these RAR
files are deployed as part of the config.vi Ant task. The following RAR
files are defined in the <code>ts.jte</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">whitebox-tx=java:comp/env/eis/whitebox-tx
whitebox-notx=java:comp/env/eis/whitebox-notx
whitebox-xa=java:comp/env/eis/whitebox-xa
whitebox-tx-param=java:comp/env/eis/whitebox-tx-param
whitebox-notx-param=java:comp/env/eis/whitebox-notx-param
whitebox-xa-param=java:comp/env/eis/whitebox-xa-param
whitebox-embed-xa=
"__SYSTEM/resource/ejb_Tsr#whitebox-xa#com.sun.ts.tests.common.connector.whitebox.TSConnectionFactory"</code></pre>
</div>
</div>
</li>
<li>
<p>The embedded RAR files are located in the
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/xa/ee/tsr</code> directory.</p>
</li>
<li>
<p>The EIS RAR files are located in the following directory:
<code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/common/connector/whitebox</code><br>
RAR files in the <code>&lt;TS_HOME&gt;/src/com/sun/ts/tests/common/connector</code>
directory must be built before any dependent tests can pass. Deployment
can either be done ahead of time or at runtime, as long as connection
pools and resources are established prior to test execution.<br>
The XA tests make use of existing connector RAR files, which typically
get deployed when the <code>config.vi</code> Ant task is run. Note that there are
currently no <code>JDBCwhitebox</code> source files and no <code>JDNCwhitebox</code> RAR
files.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GKKOJ"></a><a id="jakarta-enterprise-beans-3.2-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_12_jakarta_enterprise_beans_3_2_test_setup">5.4.12 Jakarta Enterprise Beans 3.2 Test Setup</h4>
<div class="paragraph">
<p>This section explains special configuration that needs to be completed
before running the Jakarta Enterprise Beans 3.2 DataSource and Stateful Timeout tests.</p>
</div>
<div class="paragraph">
<p>The Jakarta Enterprise Beans 3.2 DataSource tests do not test XA capability and XA support in
a database product is typically not required for these tests. However,
some Jakarta EE products could be implemented in such a way that XA must be
supported by the database. For example, when processing the
@DataSourceDefinition annotation or <code>&lt;data-source&gt;</code> descriptor elements
in tests, a Jakarta EE product infers the datasource type from the
interface implemented by the driver class. When the driver class
implements multiple interfaces, such as <code>javax.sql.DataSource</code>,
<code>javax.sql.ConnectionPoolDataSource</code>, or <code>javax.sql.XADataSource</code>, the
vendor must choose which datasource type to use. If
<code>javax.sql.XADataSource</code> is chosen, the target datasource system must be
configured to support XA. Consult the documentation for your database
system and JDBC driver for information that explains how to enable XA
support.</p>
</div>
<div class="paragraph">
<p><a id="GJYBW"></a><a id="to-configure-the-test-environment-to-run-the-jakarta-enterprise-beans-3.2-datasource-tests"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_12_1_to_configure_the_test_environment_to_run_the_jakarta_enterprise_beans_3_2_datasource_tests">5.4.12.1 To Configure the Test Environment to Run the Jakarta Enterprise Beans 3.2 DataSource Tests</h5>
<div class="paragraph">
<p>The EJB 3.2 DataSource tests under the following <code>tests/ejb30</code>
directories require you to run the Ant task in Step <a href="#BABBGJAF">2</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>com/sun/ts/tests/ejb30/lite/packaging/war/datasource</code></p>
</li>
<li>
<p><code>com/sun/ts/tests/ejb30/misc/datasource</code></p>
</li>
<li>
<p><code>com/sun/ts/tests/ejb30/assembly/appres</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your database vendor requires you to set any vendor-specific or less
common DataSource properties, complete step <a href="#BABDIIGI">1</a> and then
complete step <a href="#BABBGJAF">2</a>, as explained below.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a id="BABDIIGI"></a> Set any vendor-specific or less common datasource properties with the
<code>jdbc.datasource.props</code> property in the <code>ts.jte</code> file.<br>
The value of the property is a comma-separated array of name-value
pairs, in which each property pair uses a <code>"name=value"</code> format,
including the surrounding double quotes.<br>
The value of the property must not contain any extra spaces.<br>
For example:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">jdbc.datasource.props="driverType=thin","name2=vale2"</code></pre>
</div>
</div>
</li>
<li>
<p><a id="BABBGJAF"></a> Run the <code>configure.datasource.tests</code> Ant target to rebuild the Jakarta Enterprise Beans 3.2
DataSource Definition tests using the new database settings specified in
the <code>ts.jte</code> file.<br>
This step must be completed for Jakarta EE 8 and Jakarta EE 8 Web Profile
testing.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GJYCF"></a><a id="to-configure-the-test-environment-to-run-the-jakarta-enterprise-beans-3.2-stateful-timeout-tests"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_12_2_to_configure_the_test_environment_to_run_the_jakarta_enterprise_beans_3_2_stateful_timeout_tests">5.4.12.2 To Configure the Test Environment to Run the Jakarta Enterprise Beans 3.2 Stateful Timeout Tests</h5>
<div class="paragraph">
<p>The Jakarta Enterprise Beans 3.2 Stateful Timeout Tests in the following test directories
require special setup:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>com/sun/ts/tests/ejb30/lite/stateful/timeout</code></p>
</li>
<li>
<p><code>com/sun/ts/tests/ejb30/bb/session/stateful/timeout</code></p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the <code>javatest.timeout.factor</code> property in the <code>ts.jte</code> file to a
value such that the JavaTest harness does not time out before the test
completes.<br>
A value of 2.0 or greater should be sufficient.</p>
</li>
<li>
<p>Set the <code>test.ejb.stateful.timeout.wait.seconds</code> property, which
specifies the minimum amount of time, in seconds, that the test client
waits before verifying the status of the target stateful bean, to a
value that is appropriate for your server.<br>
The value of this property must be an integer number. The default value
is 480 seconds. This value can be set to a smaller number (for example,
240 seconds) to speed up testing, depending on the stateful timeout
implementation strategy in the target server.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEXOX"></a><a id="jakarta-enterprise-beans-timer-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_13_jakarta_enterprise_beans_timer_test_setup">5.4.13 Jakarta Enterprise Beans Timer Test Setup</h4>
<div class="paragraph">
<p>Set the following properties in the <code>ts.jte</code> file to configure the Jakarta Enterprise Beans
timer tests:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ejb_timeout=[interval_in_milliseconds]
ejb_wait=[interval_in_milliseconds]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>ejb_timeout</code> property sets the duration of single-event and
interval timers. The default setting and recommended minimum value is
<code>30000</code> milliseconds.</p>
</li>
<li>
<p>The <code>ejb_wait</code> property sets the period for the test client to wait
for results from the <code>ejbTimeout()</code> method. The default setting and
recommended minimum value is <code>60000</code> milliseconds.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Jakarta EE 8 CTS does not have a property that you can set to configure the
date for date timers.</p>
</div>
<div class="paragraph">
<p>The timer tests use the specific <code>jndi-name</code> jdbc`/DBTimer` for the
datasource used for container-managed persistence to support the use of
an XA datasource in the Jakarta EE 8 timer implementation. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;jdbc-resource enabled="true" jndi-name="jdbc/DBTimer"
               object-type="user" pool-name="cts-javadb-XA-pool" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The test directories that use this datasource are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ejb/ee/timer
ejb/ee/bb/entity/bmp/allowedmethostest
ejb/ee/bb/entity/cmp20/allowedmethodstest</code></pre>
</div>
</div>
<div class="paragraph">
<p>When testing against the Jakarta Platform, Enterprise Edition CI, Eclipse GlassFish 5.1, you must
first start the Derby DB and initialize it in addition to any other database
you may be using, as explained in <a href="#GEWUI">Configuring the Jakarta EE 8
CI as the VI</a>.</p>
</div>
<div class="paragraph">
<p><a id="GEXQB"></a><a id="entity-bean-container-managed-persistence-test-setup-for-jakarta-enterprise-beans-v-1.1"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_14_entity_bean_container_managed_persistence_test_setup_for_jakarta_enterprise_beans_v_1_1">5.4.14 Entity Bean Container-Managed Persistence Test Setup for Jakarta Enterprise Beans V 1.1</h4>
<div class="paragraph">
<p>Your Jakarta Platform, Enterprise Edition implementation should map the
following instance variables to a backend datastore. These are needed to
run the CTS entity bean container-managed persistence (cmp1.1) tests.</p>
</div>
<div class="paragraph">
<p>The Jakarta Platform, Enterprise Edition CI creates the table used by
container-managed persistence by appending <code>"Table"</code> to the bean name.
For example, if your bean name is <code>TestEJB</code>, the table that will be
created will be <code>TestEJBTable</code>.</p>
</div>
<div class="paragraph">
<p>The container-managed fields for most <code>cmp</code> tests must have the
following names and the following Java types:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 50%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Column Name</th>
<th class="tableblock halign-left valign-top">Java Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>key_id</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integer</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>brand_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>price</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Float</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>These instance variable names correspond to the following database
schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">KEY_ID (INTEGER NOT NULL)
BRAND_NAME (VARCHAR(32))
PRICE (FLOAT)
PRIMARY KEY (KEY_ID)</code></pre>
</div>
</div>
<div class="paragraph">
<p>These instance variables are used in the transactional entity test bean
for the transactional test cases (<code>tx</code>) and in the database support
utility class for the bean behavior test cases (<code>bb</code>). These instance
variables, used in the enterprise bean tests, must be accessible at
deployment time.</p>
</div>
<div class="paragraph">
<p>The Jakarta Platform, Enterprise Edition CI, Eclipse GlassFish 5.1 provides the container-managed
persistence implementation-specific features as part of its runtime XML
file. Your Jakarta Platform, Enterprise Edition platform implementation
needs to map the container-managed fields to the appropriate backend
datastore. The manner in which you do this is implementation-specific.
The <code>DeploymentInfo</code> class provides all of the runtime XML information
as an object that is passed to the <code>TSDeploymentInterface2</code>
implementation.</p>
</div>
<div class="paragraph">
<p>For a list of SQL statements used in CMP 1.1 finders, refer to
<a href="ejbql-schema.html#GFKQT">SQL Statements for CMP 1.1 Finders</a>.</p>
</div>
<div class="paragraph">
<p><a id="GEXOL"></a><a id="jakarta-persistence-api-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_15_jakarta_persistence_api_test_setup">5.4.15 Jakarta Persistence API Test Setup</h4>
<div class="paragraph">
<p>The Jakarta Persistence API tests exercise the requirements as defined in
the Jakarta Persistence API Specification. This specification defines a
persistence context to be a set of managed entity instances, in which
for any persistent identity there is a unique entity instance. Within
the persistence context, the entity instances and their life cycles are
managed by the entity manager.</p>
</div>
<div class="paragraph">
<p>Within a Jakarta Platform, Enterprise Edition environment, support for both
container-managed and application-managed entity managers is required.
Application-managed entity managers can be Jakarta Transactions or resource-local. Refer
to Chapter 8 of the Jakarta Persistence API Specification
(<code>http://jcp.org/en/jsr/detail?id=338</code>) for additional information
regarding entity managers.</p>
</div>
<div class="paragraph">
<p><a id="GJKPA"></a><a id="to-configure-the-test-environment-to-run-the-jakarta-persistence-pluggability-tests"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_15_1_to_configure_the_test_environment_to_run_the_jakarta_persistence_pluggability_tests">5.4.15.1 To Configure the Test Environment to Run the Jakarta Persistence Pluggability Tests</h5>
<div class="paragraph">
<p>The Jakarta Persistence Pluggability tests under the
<code>src/com/sun/ts/tests/jpa/ee/pluggability</code> directory ensure that a
third-party persistence provider is pluggable, in nature.</p>
</div>
<div class="paragraph">
<p>After Java EE 7 CTS, the pluggability tests were rewritten to use a
stubbed-out legacy JPA 2.1 implementation, which is located in the
<code>src/com/sun/ts/jpa/common/pluggibility/altprovider</code> directory.</p>
</div>
<div class="paragraph">
<p>In Java EE 7 CTS, the Persistence API pluggability tests required
special setup to run. This is no longer the case, since Jakarta EE 8 CTS
now enables the pluggability tests to be executed automatically along
with all the other Persistence tests. The Jakarta Persistence tests have a new
directory structure. In Java EE 7 CTS, the tests were in the
<code>src/com/sun/ts/tests/ejb30/persistence</code> directory. The Jakarta EE 8 tests are now in
the <code>src/com/sun/ts/tests/jpa</code> directory.</p>
</div>
<div class="paragraph">
<p><a id="sthref19"></a><a id="enabling-second-level-caching-support"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_15_2_enabling_second_level_caching_support">5.4.15.2 Enabling Second Level Caching Support</h5>
<div class="paragraph">
<p>Jakarta Persistence supports the use of a second-level cache by the
persistence provider. The <code>ts.jte</code> file provides a property that
controls the CTS test suite&#8217;s use of the second-level cache.</p>
</div>
<div class="paragraph">
<p>The <code>persistence.second.level.caching.supported</code> property is used to
determine if the persistence provider supports the use of a second-level
cache. The default value is true. If your persistence provider does not
support second level caching, set the value to false.</p>
</div>
<div class="paragraph">
<p><a id="GEXOW"></a><a id="persistence-test-vehicles"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_15_3_persistence_test_vehicles">5.4.15.3 Persistence Test Vehicles</h5>
<div class="paragraph">
<p>The persistence tests are run in a variety of "vehicles" from which the
entity manager is obtained and the transaction type is defined for use.
There are six vehicles used for these tests:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>stateless3</code>: Bean-managed stateless session bean using JNDI to lookup
a Jakarta Transactions <code>EntityManager</code>; uses <code>UserTransaction</code> methods for transaction
demarcation</p>
</li>
<li>
<p><code>stateful3</code>: Container-managed stateful session bean using
<code>@PersistenceContext</code> annotation to inject Jakarta Transactions <code>EntityManager;</code> uses
container-managed transaction demarcation with a transaction attribute
(required)</p>
</li>
<li>
<p><code>appmanaged</code>: Container-managed stateful session bean using
<code>@PersistenceUnit</code> annotation to inject an <code>EntityManagerFactory</code>; the
<code>EntityManagerFactory</code> API is used to create an Application-Managed Jakarta Transactions
<code>EntityManager</code>, and uses the container to demarcate transactions</p>
</li>
<li>
<p><code>appmanagedNoTx</code>: Container-managed stateful session bean using
<code>@PersistenceUnit</code> annotation to inject an <code>EntityManagerFactory</code>; the
<code>EntityManagerFactory</code> API is used to create an Application-Managed
Resource Local <code>EntityManager</code>, and uses the <code>EntityTransaction</code> APIs to
control transactions</p>
</li>
<li>
<p><code>pmservlet</code>: Servlet that uses the <code>@PersistenceContext</code> annotation at
the class level and then uses JNDI lookup to obtain the <code>EntityManager</code>;
alternative to declaring the persistence context dependency via a
<code>persistence-context-ref</code> in <code>web.xml</code> and uses <code>UserTransaction</code>
methods for transaction demarcation</p>
</li>
<li>
<p><code>puservlet</code>: Servlet that injects an <code>EntityManagerFactory</code> using the
<code>@PersistenceUnit</code> annotation to create a to Resource Local
<code>EntityManager</code>, and uses <code>EntityTransaction</code> APIs for transaction
demarcation</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>For vehicles using a <code>RESOURCE_LOCAL</code> transaction type, be sure to
configure a non-transactional resource with the logical name
<code>jdbc/DB_no_tx</code>. Refer to the <code>ts.jte</code> file for information about the
<code>jdbc.db</code> property.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEXPY"></a><a id="generatedvalue-annotation"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_15_4_generatedvalue_annotation">5.4.15.4 GeneratedValue Annotation</h5>
<div class="paragraph">
<p>The Jakarta Persistence API Specification also defines the requirements for
the <code>GeneratedValue</code> annotation. The default for this annotation is
<code>GenerationType.AUTO</code>. Per the specification, <code>AUTO</code> indicates that the
persistence provider should pick an appropriate strategy for the
particular database. The <code>AUTO</code> generation strategy may expect a
database resource to exist, or it may attempt to create one.</p>
</div>
<div class="paragraph">
<p>The <code>db.supports.sequence</code> property is used to determine if a database
supports the use of SEQUENCE. If it does not, this property should be
set to false so the test is not run. The default value is true.</p>
</div>
<div class="paragraph">
<p>If the database under test is not one of the databases defined and
supported by CTS, the user will need to create an entry similar to the
one listed in <a href="#GEXOO">Example 5-1</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="GEXOO">Example 5-1 GeneratedValue Annotation Test Table</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">DROP TABLE SEQUENCE;
CREATE TABLE SEQUENCE (SEQ_NAME VARCHAR(10), SEQ_COUNT INT, CONSTRAINT SEQUENCE_PK /
PRIMARY KEY (SEQ_NAME) );
INSERT into SEQUENCE(SEQ_NAME, SEQ_COUNT) values ('SEQ_GEN', 0) ;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should add your own table to your chosen database DDL file provided
prior to running these tests. The Data Model used to test the Jakarta
Persistence Query Language can be found in
<a href="ejbql-schema.html#GFAVUc">Appendix E, "EJBQL Schema."</a></p>
</div>
<div class="paragraph">
<p>The <code>persistence.xml</code> file, which defines a persistence unit, contains
the <code>unitName</code> <code>CTS-EM</code> for Jakarta Transactions entity managers. This corresponds to
<code>jta-data-source</code>, <code>jdbc/DB1</code>, and to <code>CTS-EM-NOTX</code> for <code>RESOURCE_LOCAL</code>
entity managers, which correspond to a <code>non-jta-data-source</code>
<code>jdbc/DB_no_tx</code>.</p>
</div>
<div class="paragraph">
<p><a id="GEXPT"></a><a id="jakarta-messaging-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_16_jakarta_messaging_test_setup">5.4.16 Jakarta Messaging Test Setup</h4>
<div class="paragraph">
<p>This section explains how to set up and configure the Jakarta EE 8 CTS test
suite before running the Jakarta Messaging tests.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>The client-specified values for <code>JMSDeliveryMode</code>, <code>JMSExpiration</code>, and
<code>JMSPriority</code> must not be overridden when running the CTS Jakarta Messaging tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="sthref20"></a><a id="to-configure-a-slow-running-system"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_16_1_to_configure_a_slow_running_system">5.4.16.1 To Configure a Slow Running System</h5>
<div class="paragraph">
<p>Make sure that the following property has been set in the <code>ts.jte</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">jms_timeout=10000</code></pre>
</div>
</div>
<div class="paragraph">
<p>This property specifies the length of time, in milliseconds, that a
synchronous receive operation will wait for a message. The default value
of the property should be sufficient for most environments. If, however,
your system is running slowly and you are not receiving the messages
that you should be, you need to increase the value of this parameter.</p>
</div>
<div class="paragraph">
<p><a id="sthref21"></a><a id="to-test-your-jakarta-messaging-resource-adapter"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_16_2_to_test_your_jakarta_messaging_resource_adapter">5.4.16.2 To Test Your Jakarta Messaging Resource Adapter</h5>
<div class="paragraph">
<p>If your implementation supports Jakarta Messaging as a Resource Adapter, you must set
the name of the <code>jmsra.name</code> property in the <code>ts.jte</code> file to the name
of your Jakarta Messaging Resource Adapter. The default value for the property is the
name of the Jakarta Messaging Resource Adapter in the Jakarta EE 8 CI.</p>
</div>
<div class="paragraph">
<p>If you modify the <code>jmsra.name</code> property, you must rebuild the Jakarta Messaging tests
that use this property. You rebuild the tests by doing the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change to the <code>TS_HOME/bin</code> directory.</p>
</li>
<li>
<p>Invoke the following Ant task:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant rebuild.jms.rebuildable.tests</code></pre>
</div>
</div>
<div class="paragraph">
<p>This rebuilds the tests under
<code>TS_HOME/src/com/sun/ts/tests/jms/ee20/resourcedefs</code>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="sthref22"></a><a id="to-create-jakarta-messaging-administered-objects"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_16_3_to_create_jakarta_messaging_administered_objects">5.4.16.3 To Create Jakarta Messaging Administered Objects</h5>
<div class="paragraph">
<p>If you do not have an API to create Jakarta Messaging Administered objects, and you
cannot create an Ant target equivalent to <code>config.vi</code>, you can use the
list that follows and manually create the objects. If you decide to
create these objects manually, you need to provide a dummy
implementation of the Jakarta Messaging porting interface, <code>TSJMSAdminInterface</code>.</p>
</div>
<div class="paragraph">
<p>The list of objects you need to manually create includes the following
factories, queues, and topics.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Factories:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">jms/TopicConnectionFactory
jms/DURABLE_SUB_CONNECTION_FACTORY, clientId=cts
jms/MDBTACCESSTEST_FACTORY, clientId=cts1
jms/DURABLE_BMT_CONNECTION_FACTORY, clientId=cts2
jms/DURABLE_CMT_CONNECTION_FACTORY, clientId=cts3
jms/DURABLE_BMT_XCONNECTION_FACTORY, clientId=cts4
jms/DURABLE_CMT_XCONNECTION_FACTORY, clientId=cts5
jms/DURABLE_CMT_TXNS_XCONNECTION_FACTORY, clientId=cts6
jms/QueueConnectionFactory
jms/ConnectionFactory</code></pre>
</div>
</div>
</li>
<li>
<p>Queues:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">MDB_QUEUE
MDB_QUEUE_REPLY
MY_QUEUE
MY_QUEUE2
Q2
QUEUE_BMT
ejb_ee_bb_localaccess_mdbqaccesstest_MDB_QUEUE
ejb_ee_deploy_mdb_ejblink_casesensT_ReplyQueue
ejb_ee_deploy_mdb_ejblink_casesens_ReplyQueue
ejb_ee_deploy_mdb_ejblink_casesens_TestBean
ejb_ee_deploy_mdb_ejblink_scopeT_ReplyQueue
ejb_ee_deploy_mdb_ejblink_scope_ReplyQueue
ejb_ee_deploy_mdb_ejblink_scope_TestBean
ejb_ee_deploy_mdb_ejblink_singleT_ReplyQueue
ejb_ee_deploy_mdb_ejblink_single_ReplyQueue
ejb_ee_deploy_mdb_ejblink_single_TestBean
ejb_ee_deploy_mdb_ejblink_single_TestBeanBMT
ejb_ee_deploy_mdb_ejbref_casesensT_ReplyQueue
ejb_ee_deploy_mdb_ejbref_casesens_ReplyQueue
ejb_ee_deploy_mdb_ejbref_casesens_TestBean
ejb_ee_deploy_mdb_ejbref_scopeT_ReplyQueue
ejb_ee_deploy_mdb_ejbref_scope_Cyrano
ejb_ee_deploy_mdb_ejbref_scope_ReplyQueue
ejb_ee_deploy_mdb_ejbref_scope_Romeo
ejb_ee_deploy_mdb_ejbref_scope_Tristan
ejb_ee_deploy_mdb_ejbref_singleT_ReplyQueue
ejb_ee_deploy_mdb_ejbref_single_ReplyQueue
ejb_ee_deploy_mdb_ejbref_single_TestBean
ejb_ee_deploy_mdb_ejbref_single_TestBeanBMT
ejb_ee_deploy_mdb_enventry_casesensT_ReplyQueue
ejb_ee_deploy_mdb_enventry_casesens_CaseBean
ejb_ee_deploy_mdb_enventry_casesens_CaseBeanBMT
ejb_ee_deploy_mdb_enventry_casesens_ReplyQueue
ejb_ee_deploy_mdb_enventry_scopeT_ReplyQueue
ejb_ee_deploy_mdb_enventry_scope_Bean1_MultiJar
ejb_ee_deploy_mdb_enventry_scope_Bean1_SameJar
ejb_ee_deploy_mdb_enventry_scope_Bean2_MultiJar
ejb_ee_deploy_mdb_enventry_scope_Bean2_SameJar
ejb_ee_deploy_mdb_enventry_scope_ReplyQueue
ejb_ee_deploy_mdb_enventry_singleT_ReplyQueue
ejb_ee_deploy_mdb_enventry_single_AllBean
ejb_ee_deploy_mdb_enventry_single_AllBeanBMT
ejb_ee_deploy_mdb_enventry_single_BooleanBean
ejb_ee_deploy_mdb_enventry_single_ByteBean
ejb_ee_deploy_mdb_enventry_single_DoubleBean
ejb_ee_deploy_mdb_enventry_single_FloatBean
ejb_ee_deploy_mdb_enventry_single_IntegerBean
ejb_ee_deploy_mdb_enventry_single_LongBean
ejb_ee_deploy_mdb_enventry_single_ReplyQueue
ejb_ee_deploy_mdb_enventry_single_ShortBean
ejb_ee_deploy_mdb_enventry_single_StringBean
ejb_ee_deploy_mdb_resref_singleT_ReplyQueue
ejb_ee_deploy_mdb_resref_single_ReplyQueue
ejb_ee_deploy_mdb_resref_single_TestBean
ejb_ee_sec_stateful_mdb_MDB_QUEUE
ejb_sec_mdb_MDB_QUEUE_BMT
ejb_sec_mdb_MDB_QUEUE_CMT
jms_ee_mdb_mdb_exceptQ_MDB_QUEUETXNS_CMT
jms_ee_mdb_mdb_exceptQ_MDB_QUEUE_BMT
jms_ee_mdb_mdb_exceptQ_MDB_QUEUE_CMT
jms_ee_mdb_mdb_exceptT_MDB_QUEUETXNS_CMT
jms_ee_mdb_mdb_exceptT_MDB_QUEUE_BMT
jms_ee_mdb_mdb_exceptT_MDB_QUEUE_CMT
jms_ee_mdb_mdb_msgHdrQ_MDB_QUEUE
jms_ee_mdb_mdb_msgPropsQ_MDB_QUEUE
jms_ee_mdb_mdb_msgTypesQ1_MDB_QUEUE
jms_ee_mdb_mdb_msgTypesQ2_MDB_QUEUE
jms_ee_mdb_mdb_msgTypesQ3_MDB_QUEUE
jms_ee_mdb_mdb_rec_MDB_QUEUE
jms_ee_mdb_sndQ_MDB_QUEUE
jms_ee_mdb_sndToQueue_MDB_QUEUE
jms_ee_mdb_mdb_synchrec_MDB_QUEUE
jms_ee_mdb_xa_MDB_QUEUE_BMT
jms_ee_mdb_xa_MDB_QUEUE_CMT
testQ0
testQ1
testQ2
testQueue2
fooQ</code></pre>
</div>
</div>
</li>
<li>
<p>Topics:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">MY_TOPIC
MY_TOPIC2
TOPIC_BMT
ejb_ee_bb_localaccess_mdbtaccesstest_MDB_TOPIC
ejb_ee_deploy_mdb_ejblink_casesensT_TestBean
ejb_ee_deploy_mdb_ejblink_scopeT_TestBean
ejb_ee_deploy_mdb_ejblink_singleT_TestBean
ejb_ee_deploy_mdb_ejblink_singleT_TestBeanBMT
ejb_ee_deploy_mdb_ejbref_casesensT_TestBean
ejb_ee_deploy_mdb_ejbref_scopeT_Cyrano
ejb_ee_deploy_mdb_ejbref_scopeT_Romeo
ejb_ee_deploy_mdb_ejbref_scopeT_Tristan
ejb_ee_deploy_mdb_ejbref_singleT_TestBean
ejb_ee_deploy_mdb_ejbref_singleT_TestBeanBMT
ejb_ee_deploy_mdb_enventry_casesensT_CaseBean
ejb_ee_deploy_mdb_enventry_casesensT_CaseBeanBMT
ejb_ee_deploy_mdb_enventry_scopeT_Bean1_MultiJar
ejb_ee_deploy_mdb_enventry_scopeT_Bean1_SameJar
ejb_ee_deploy_mdb_enventry_scopeT_Bean2_MultiJar
ejb_ee_deploy_mdb_enventry_scopeT_Bean2_SameJar
ejb_ee_deploy_mdb_enventry_singleT_AllBean
ejb_ee_deploy_mdb_enventry_singleT_AllBeanBMT
ejb_ee_deploy_mdb_enventry_singleT_BooleanBean
ejb_ee_deploy_mdb_enventry_singleT_ByteBean
ejb_ee_deploy_mdb_enventry_singleT_DoubleBean
ejb_ee_deploy_mdb_enventry_singleT_FloatBean
ejb_ee_deploy_mdb_enventry_singleT_IntegerBean
ejb_ee_deploy_mdb_enventry_singleT_LongBean
ejb_ee_deploy_mdb_enventry_singleT_ShortBean
ejb_ee_deploy_mdb_enventry_singleT_StringBean
ejb_ee_deploy_mdb_resref_singleT_TestBean
jms_ee_mdb_mdb_exceptT_MDB_DURABLETXNS_CMT
jms_ee_mdb_mdb_exceptT_MDB_DURABLE_BMT
jms_ee_mdb_mdb_exceptT_MDB_DURABLE_CMT
jms_ee_mdb_mdb_msgHdrT_MDB_TOPIC
jms_ee_mdb_mdb_msgPropsT_MDB_TOPIC
jms_ee_mdb_mdb_msgTypesT1_MDB_TOPIC
jms_ee_mdb_mdb_msgTypesT2_MDB_TOPIC
jms_ee_mdb_mdb_msgTypesT3_MDB_TOPIC
jms_ee_mdb_mdb_rec_MDB_TOPIC
jms_ee_mdb_mdb_sndToTopic_MDB_TOPIC
jms_ee_mdb_mdb_sndToTopic_MDB_TOPIC_REPLY
jms_ee_mdb_xa_MDB_DURABLE_BMT
jms_ee_mdb_xa_MDB_DURABLE_CMT
testT0
testT1
testT2</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Implementations of <code>TSJMSAdminInterface</code> are called inside the JavaTest
VM. The <code>com.sun.ts.lib.deliverable.cts.CTSPropertyManager</code> class, which
is available to these implementations, provides access to any property
in the <code>ts.jte</code> file.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEXQR"></a><a id="transaction-interoperability-testing"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_17_transaction_interoperability_testing">5.4.17 Transaction Interoperability Testing</h4>
<div class="paragraph">
<p>Using two Jakarta Platform, Enterprise Edition server implementations, you
can test up to four transaction interoperability configurations.
However, note that you only need to test and pass configurations that
your Jakarta Platform, Enterprise Edition server supports.
<a href="#GEXOC">Table 5-1</a> shows these configurations.</p>
</div>
<div class="paragraph">
<p><a id="sthref23"></a><a id="GEXOC"></a></p>
</div>
<div class="sect4">
<h5 id="_table_5_1_transaction_interoperability_testing_configurations">Table 5-1 Transaction Interoperability Testing Configurations</h5>
<table class="tableblock frame-all grid-all" style="width: 80%;">
<colgroup>
<col style="width: 34%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Configuration</th>
<th class="tableblock halign-left valign-top">Transaction Interoperability Setting for a Jakarta
Platform, Enterprise Edition Vendor Implementation</th>
<th class="tableblock halign-left valign-top">Transaction
Interoperability Setting for the Jakarta Platform, Enterprise Edition CI</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ON</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ON</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Modify the interoperability settings for transaction interoperability
according to what you need to test:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If your implementation supports transaction interoperability, you must
test configurations #1 and #2.</p>
</li>
<li>
<p>If your implementation does not support transaction interoperability,
you must test configurations #3 and #4.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>ts.jte</code> file has the following transaction interoperability
properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">EJBServer1TxInteropEnabled=[false | true]
EJBServer2TxInteropEnabled=[false | true]</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run the required test configurations described in <a href="#GEXOC">Table
5-1</a>, use the following commands to change the Jakarta Platform, Enterprise
Edition SDK settings as necessary.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To set the Jakarta Platform, Enterprise Edition CI Transaction
Interoperability setting to <code>False</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant disable.ri.tx.interop</code></pre>
</div>
</div>
</li>
<li>
<p>To set the Jakarta Platform, Enterprise Edition CI Transaction
Interoperability setting to <code>True</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant enable.ri.tx.interop</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default Jakarta Platform, Enterprise Edition CI Transaction
Interoperability setting is <code>True</code>.</p>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GKWVB"></a><a id="jakarta-authentication-service-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_18_jakarta_authentication_service_test_setup">5.4.18 Jakarta Authentication Service Test Setup</h4>
<div class="paragraph">
<p>Jakarta Authentication Service for Containers (Authentication)
1.1 tests are security tests. The Jakarta Authentication Servlet (jaspicservlet) profile is the only
required profile for Jakarta EE 8 CTS. There are other optional profile
tests, such as SOAP, but you are not required to run these for
certification.</p>
</div>
<div class="paragraph">
<p>The test suite includes the following Ant targets that configure the
test environment for the Jakarta Authentication tests</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>config_vi</code> target in <code>&lt;TS_HOME&gt;/bin/build.xml</code></p>
</li>
<li>
<p><code>enable.jaspic</code>, also in <code>&lt;TS_HOME&gt;/bin/build.xml</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Both targets call <code>&lt;TS_HOME&gt;/bin/xml/impl/glassfish/javaee_vi.xml</code>,
which then makes calls into <code>&lt;TS_HOME&gt;/bin/xml/impl/glassfish/s1as.xml</code>.
You may want to examine these targets to see what is done in greater
detail.</p>
</div>
<div class="paragraph">
<p>Complete the following steps before you run the Jakarta Authentication tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the Jakarta Authentication-required properties in the <code>ts.jte</code> file:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Set the <code>provider.configuration.file</code> property to the location of
your implementation&#8217;s instance <code>lib</code> directory, where it can be loaded
when your implementation runtime is started.<br>
This file typically coexists with the <code>tssv.jar</code> file and the
<code>provider-configuration.dtd</code> file.</p>
</li>
<li>
<p>Set the <code>vendor.authconfig.factory</code> property to specify your
<code>AuthConfigFactory</code> class.<br>
This property setting will be used by the Jakarta Authentication tests to register the
test suite&#8217;s provider in your <code>AuthConfigFactory</code>.</p>
</li>
<li>
<p>Set the <code>logical.hostname.servlet</code> property to the logical host that
will process Servlet requests.<br>
Servlet requests may be directed to a logical host using various
physical or virtual host names or addresses. A message processing
runtime may be composed of multiple logical hosts. This setting is
required to properly identify the Servlet profile&#8217;s application context
identifier hostname. If the logical host that will process Servlet
requests does not exist, you can set this to the default hostname of
your implementation&#8217;s Web server.</p>
</li>
<li>
<p>Set the <code>servlet.is.jsr115.compatible</code> property based on whether or
not you are running the Servlet profile in a Jakarta Authorization 1.5 compatible
container.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Ensure that the <code>config.vi</code> Ant task has been run before running the
<code>enable.jaspic</code> Ant task.<br>
These Ant tasks perform the following Jakarta Authentication-required steps:</p>
<div class="ulist">
<ul>
<li>
<p>Set up users and passwords for your implementation.<br>
See Step <a href="#BABDADHA">9</a><a href="#BABBHFAI">b</a> in <a href="#GEWWA">Configuring
Your Application Server as the VI</a> for more information.</p>
</li>
<li>
<p>Install the client-side certificate in the <code>trustStore</code> in your
implementation.<br>
See Step <a href="#BABEGCJH">17</a> in <a href="#GEWWA">Configuring Your Application
Server as the VI</a> for more information.</p>
</li>
<li>
<p>Append the file <code>&lt;TS_HOME&gt;/bin/server_policy.append</code> to the Java
policy file or files on your implementation.<br>
See Step 17 in <a href="#GEWWA">Configuring Your Application Server as the
VI</a><a href="#GEWWA">Configuring Your Application Server as the VI</a> for more
information.</p>
</li>
<li>
<p>Appends the file <code>&lt;TS_HOME&gt;/bin/client_policy.append</code> to the
application client&#8217;s Java policy file, which is referenced in the
<code>TestExecuteAppClient</code> section of the <code>ts.jte</code> file.<br>
See Step 18 in <a href="#GEWWA">Configuring Your Application Server as the
VI</a><a href="#GEWWA">Configuring Your Application Server as the VI</a> for more
information.</p>
</li>
<li>
<p>Copies the <code>&lt;TS_HOME&gt;/lib/tssv.jar</code> file to your implementation
instance library directory.<br>
The <code>tssv.jar</code> file includes the class files necessary to load
<code>TSAuthConfigFactory</code> and related classes.</p>
</li>
<li>
<p>Copies the TSSV configuration files (<code>ProviderConfiguration.xml</code>,
<code>configuration.dtd</code>) to your implementation instance library directory.<br>
The <code>provider-configuration.dtd</code> file is a DTD file that resides in the
same directory as the <code>ProviderConfiguration.xml</code> file and describes the
<code>ProviderConfiguration.xml</code> file. This file should not be edited.</p>
</li>
<li>
<p>Copies <code>&lt;TS_HOME&gt;/bin/ts.java.security</code> to
<code>&lt;JAVAEE_HOME&gt;/domains/domain1/config/ts.java.security</code>, where
<code>&lt;JAVAEE_HOME&gt;</code> is the location of your Jakarta EE 8 CI installation.</p>
</li>
<li>
<p>Sets the following JVM options:</p>
<div class="ulist">
<ul>
<li>
<p><code>-Djava.security.properties=&lt;JAVAEE_HOME&gt;/domains/domain1/config/ts.java.security</code></p>
</li>
<li>
<p><code>-Dlog.file.location=${log.file.location}</code></p>
</li>
<li>
<p><code>-Dprovider.configuration.file=${provider.configuration.file}</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Deploy the Jakarta Authentication log file processor,
<code>&lt;TS_HOME&gt;/dist/com/sun/ts/tests/jaspic/util/jaspic_util_web.war</code>, to
the implementation under test.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>It may be necessary to restart your implementation after completing this
step.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Run the tests for the profiles with which you are trying to certify.</p>
</li>
<li>
<p>After running the Jakarta Authentication tests, change back to the <code>&lt;TS_HOME&gt;/bin</code>
directory and execute the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant disable.jaspic</code></pre>
</div>
</div>
<div class="paragraph">
<p>This Ant task undoes the changes that were made to your implementation
by the <code>enable.jaspic</code> target. If these changes are not reversed, your
implementation may be left in an uncertain state.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEXWW"></a><a id="csiv2-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_19_csiv2_test_setup">5.4.19 CSIv2 Test Setup</h4>
<div class="paragraph">
<p>Common Secure Interoperability Version 2 (CSIv2) is security-related
interoperability testing. You must complete all of the setup
instructions in <a href="#GEXMH">Configuring a Jakarta Platform, Enterprise
Edition CI and VI for Interop/Rebuildable Tests</a> and the steps provided
in this section before you run the CSIv2 tests.</p>
</div>
<div class="paragraph">
<p>This following sections describe how to set up two Jakarta Platform,
Enterprise Edition servers, one running the vendor&#8217;s Jakarta Platform,
Enterprise Edition server and the other running the Jakarta Platform,
Enterprise Edition CI. Be sure to complete the steps in
<a href="#GEWTQ">Section 5.3, "Configuring a Jakarta EE 8 Server,"</a> before
proceeding with the instructions below.</p>
</div>
<div class="paragraph">
<p>Reference information on the CSIv2 tests, security elements, and
analyzing test logs can be found in <a href="csiv2logs.html#GFAVU">Appendix B,
"CSIv2 Test Reference."</a></p>
</div>
<div class="paragraph">
<p><a id="GEXVO"></a><a id="to-configure-the-vendors-jakarta-ee-8-server"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_19_1_to_configure_the_vendor_s_jakarta_ee_8_server">5.4.19.1 To Configure the Vendor&#8217;s Jakarta EE 8 Server</h5>
<div class="paragraph">
<p>Generate the required IORs, based on the values of the fields that are
described in <a href="#GLREL">Section 5.4.19.3, "Generating IORs Based on
Runtime XML Information."</a></p>
</div>
<div class="paragraph">
<p><a href="csiv2logs.html#GFKKB">Section B.10, "IORs and Associated CSIv2
Tests,"</a> provides additional information about IOR definitions.</p>
</div>
<div class="paragraph">
<p>To configure the vendor&#8217;s Jakarta EE 8 server, you need to perform steps
similar to those in the <code>config.vi</code> task. You do not need to install the
Connector RAR files for the CSIv2/interop tests, so you could run the
following command to configure the vendor&#8217;s Jakarta EE 8 server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant -Dskip.config.connector=true config.vi</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEXVB"></a><a id="to-configure-the-jakarta-ee-8-ci-server"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_19_2_to_configure_the_jakarta_ee_8_ci_server">5.4.19.2 To Configure the Jakarta EE 8 CI Server</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Run the CSIv2 Ant target.</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant enable.csiv2</code></pre>
</div>
</div>
</li>
<li>
<p>Run the CSIv2 tests.<br>
See <a href="using.html#GBFWO">Chapter 7, "Executing Tests,"</a> for instructions
on executing tests. After the test run concludes, you need to analyze
the results. See <a href="csiv2logs.html#GFAVU">Appendix B, "CSIv2 Test
Reference,"</a> for information about analyzing the test logs.</p>
</li>
<li>
<p>Disable CSIv2.</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ant disable.csiv2</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GLREL"></a><a id="generating-iors-based-on-runtime-xml-information"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_19_3_generating_iors_based_on_runtime_xml_information">5.4.19.3 Generating IORs Based on Runtime XML Information</h5>
<div class="paragraph">
<p>The <code>DeploymentInfo</code> class contains public accessor methods that
correspond to XML elements within the <code>&lt;ior-security-config&gt;</code> element in
the Jakarta Enterprise Beans (formerly EJB) jar runtime XML that is packaged with the test beans. Jakarta
Platform, Enterprise Edition vendor implementations are required to
generate IORs that are based on the values pulled from this XML document
as described in this section. Failure to do so will result in test
failures.</p>
</div>
<div class="paragraph">
<p>The fields are divided into three categories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fields that deal with client authentication at the client
authentication layer of the CSIv2 protocol:</p>
<div class="ulist">
<ul>
<li>
<p><code>asAuthMethod</code></p>
</li>
<li>
<p><code>asRequired</code></p>
</li>
<li>
<p><code>asRealmName</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Fields that deal with the secure transport layer (SSL):</p>
<div class="ulist">
<ul>
<li>
<p><code>transportIntegrity</code></p>
</li>
<li>
<p><code>transportConfidentiality</code></p>
</li>
<li>
<p><code>EstablishTrustInTarget</code></p>
</li>
<li>
<p><code>EstablishTrustInClient</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Fields that deal with caller propagation:</p>
<div class="ulist">
<ul>
<li>
<p><code>sasCallerPropagation</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The values of these fields must be used to construct the
<code>CompoundSecMec</code> structure within an IOR. The construction of the IORs
is briefly described in this class. <a href="csiv2logs.html#GFKKB">IORs and
Associated CSIv2 Tests</a> lists all the IORS that are expected to be
generated. For more detailed information about IORS, refer to the CSIv2
specification.</p>
</div>
<div class="paragraph">
<p>Not all possible combinations of fields are used by CSIv2 tests. For
example, the following fields are used to indicate that client
authentication is required at the client authentication layer of the
CSIv2 protocol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asAuthMethod = "username_password"
asRealmName  = "default"
asRequired   = "true"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following fields are used to indicate that client authentication is
not required at the client authentication layer of the CSIv2 protocol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">asAuthMethod = "username_password"
asRealmName  = "default"
asRequired   = "false"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Java example listed below demonstrates how users can extract the
required information from the <code>DeploymentInfo</code> object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">DeploymentInfo info;
List ejbs = info.getEnterpriseBeans().getEjb();
foreach ejb in ejbs {
    ejb.getIorSecurityConfig().getAsContext().getAuthMethod().getContent();
    ejb.getIorSecurityConfig().getAsContext().getRequired().getContent();
    ejb.getIorSecurityConfig().getAsContext().getRealm().getContent();
    ejb.getIorSecurityConfig().getTransportConfig().getIntegrity().getContent();
    ejb.getIorSecurityConfig().getTransportConfig().getConfidentiality().getContent();
    ejb.getIorSecurityConfig().getTransportConfig().getEstablishTrustInClient().getContent();
    ejb.getIorSecurityConfig().getTransportConfig().getEstablishTrustInTarget().getContent();
} // end loop</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information about the <code>&lt;security-role-mapping&gt;</code> and
<code>&lt;ior-security-config&gt;</code> elements, see <a href="csiv2logs.html#GLSDH">Security
Elements Associated With CSIv2 Tests</a>.</p>
</div>
<div class="paragraph">
<p><a id="GEYBI"></a><a id="jakarta-authorization-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_20_jakarta_authorization_test_setup">5.4.20 Jakarta Authorization Test Setup</h4>
<div class="paragraph">
<p>To comply with Jakarta EE 8 requirements, Jakarta Authorization must be supported in both
the Web and Jakarta Enterprise Beans environments.
The tests for each environment are divided into two directories:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>src/com/sun/ts/tests/jacc/web</code></p>
</li>
<li>
<p><code>src/com/sun/ts/tests/jacc/ejb</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When deploying the archives that contain Jakarta Authorization tests, don&#8217;t deploy all
the Jakarta Authorization test archives at the same time. While this may work, there have
been times when it has caused problems. The recommended course of action
is to deploy the test archive for the directory under test. Once done,
remove that archive and move onto another directory.</p>
</div>
<div class="paragraph">
<p>The Jakarta Authorization-CTS provider acts as a delegating security provider sitting
between the appserver and vendor provider. The Jakarta Platform, Enterprise
Edition appserver comes with a default security provider that is defined
by two system properties; for the purposes of this discussion, these are
referred to as <code>A=DefaultProviderFactory</code> and <code>B=DefaultPolicyModule</code>.</p>
</div>
<div class="paragraph">
<p>CTS moves the values from A and B to two new variables:
<code>C=DefaultProviderFactory</code> and <code>D=DefaultPolicyModule</code>, replacing the
CTS provider classes to the variables <code>A</code> and <code>B</code> (<code>A=TSProviderFactory</code>
and <code>B=TSPolicyModule</code>). This modification allows the server to call the
CTS provider for all its functions, and the CTS provider in turn uses
these new variables to invoke the real provider.</p>
</div>
<div class="paragraph">
<p>The property names <code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code> are used for convenience here.
The real property names are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>A=javax.security.jacc.PolicyConfigurationFactory.provider</code></p>
</li>
<li>
<p><code>B=javax.security.jacc.policy.provider</code></p>
</li>
<li>
<p><code>C=vendor.javax.security.jacc.PolicyConfigurationFactory.provider</code></p>
</li>
<li>
<p><code>D=vendor.javax.security.jacc.policy.provider</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To configure the Jakarta Authorization provider for the Jakarta Platform, Enterprise Edition
CI, execute the Jakarta Authorization Ant target from:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;TS_HOME&gt;/bin</code></pre>
</div>
</div>
<div class="paragraph">
<p>This command does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Switches the system properties.</p>
</li>
<li>
<p>Adds <code>tsprovider.jar</code> to Jakarta Platform, Enterprise Edition application
server&#8217;s classpath.</p>
</li>
<li>
<p>Adds <code>log.file.location</code> system property to the Jakarta Platform,
Enterprise Edition application server&#8217;s system properties. This is used
for generating log files, which is used for verifying Jakarta Authorization 1.5 contracts.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>When running Jakarta Authorization tests against the Jakarta EE 8 CI, if you need to restart
the CI, be sure to first remove all Jakarta Authorization log files (<code>jacc_log.*</code>) from
the <code>JAVAEE_HOME/domains/domain1/logs</code> directory before running the Jakarta Authorization
tests again.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="sthref24"></a><a id="jakarta-batch-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_21_jakarta_batch_test_setup">5.4.21 Jakarta Batch Test Setup</h4>
<div class="paragraph">
<p>The Jakarta Batch tests, which are located under the
<code>&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck</code> directory, don&#8217;t require extra setup
for most implementations. However, there may be a few cases where some
customization is needed.</p>
</div>
<div class="paragraph">
<p>If you are using an injection technology other than CDI, complete the
following steps before running the Jakarta Batch tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remove the <code>&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck/testJobXml/beans.xml</code>
and <code>&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck/tests/ee/beans.xml</code> files.</p>
</li>
<li>
<p>Change to the <code>&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck</code> directory.</p>
</li>
<li>
<p>Execute the <code>ant build</code> command to rebuild the archives.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you are using a different implementation of the porting interface
<code>&lt;&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck/testJobXml/META-INF/services/com.ibm.jbatch.tck.spi.JobExecutionWaiterFactory</code>,
complete the following steps before running the Jakarta Batch tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change the entry in
<code>&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck/testJobXml/META-INF/services/com.ibm.jbatch.tck.spi.JobExecutionWaiterFactory</code>
to specify the new porting implementation class.</p>
</li>
<li>
<p>Change to the <code>&lt;TS_HOME&gt;/src/com/ibm/jbatch/tck</code> directory.</p>
</li>
<li>
<p>Execute the <code>ant build</code> command to rebuild the archives.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For information about the Jakarta Batch tests themselves, see the
<em>Technology Compatibility Kit Reference Guide for JSR-352: Batch
Applications for the Java Platform</em> at the following location:</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/WASdev/standards.jsr352.tck" class="bare">https://github.com/WASdev/standards.jsr352.tck</a></p>
</div>
<div class="paragraph">
<p><a id="GEYAM"></a><a id="wsdl-webservice-test-and-runtime-notes"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_22_wsdl_webservice_test_and_runtime_notes">5.4.22 WSDL: Webservice Test and Runtime Notes</h4>
<div class="paragraph">
<p>In addition to the WSDL elements described later in this section, the
Jakarta Platform, Enterprise Edition CI webservice runtime DTDs contain two
new optional elements for publishing and lookup of final WSDLs for a
deployed webservice endpoint. These new tags are
<code>&lt;wsdl-publish-location&gt;</code> and <code>&lt;wsdl-override&gt;</code>, and are used by the CTS
to automate all CTS webservices tests, regardless of the host or port
used to run the tests.</p>
</div>
<div class="paragraph">
<p>These WSDL tags are also used when performing file URL publishing, as
required by Jakarta Implementing Web Services 1.4. Jakarta Implementing
Web Services 1.4 states that http URL and file URL publishing
must be supported on a Jakarta Platform, Enterprise Edition platform. In
addition, the <code>&lt;wsdl-override&gt;</code> is used as a mechanism for satisfying
the partial WSDL requirement in the Jakarta Implementing Web Services
1.4 specification. This mechanism
enables the specification of the location of the final full published
WSDL of a deployed webservice endpoint within the client EAR when only a
partial WSDL is packaged, which enables client access to the full WSDL
and correct SOAP address to communicate with the webservice.</p>
</div>
<div class="paragraph">
<p>The <code>&lt;wsdl-publish-location&gt;</code> tag tells the Jakarta Platform, Enterprise
Edition CI where to publish the final WSDL for the deployed webservice
endpoint. As stated above, the final WSDL can be published to a file URL
or http URL, although the tag is really only necessary for file URL
publishing, and is ignored if http URL publishing is specified (http is
the default publishing used by the Jakarta Platform, Enterprise Edition
CI). This tag is included in all CTS tests for consistency and to aid as
a mechanism in automation.</p>
</div>
<div class="paragraph">
<p>By default, the Jakarta Platform, Enterprise Edition CI publishes the final
WSDL during deployment to a http URL following a standard URL naming
scheme. See below for details about the Jakarta Platform, Enterprise
Edition CI runtime. This default can be overriden to explicitly do file
URL publishing.</p>
</div>
<div class="paragraph">
<p>The <code>&lt;wsdl-override&gt;</code> tag tells the client application EAR where to
lookup the final published WSDL for the deployed webservice endpoint.
This will be either a <code>file</code> URL or an <code>http</code> URL to match what is
specified in the <code>&lt;wsdl-publish-location&gt;</code> tag.</p>
</div>
<div class="paragraph">
<p><a id="GEYAJ"></a><a id="wsdl-ts.jte-properties"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_22_1_wsdl_ts_jte_properties">5.4.22.1 WSDL ts.jte Properties</h5>
<div class="paragraph">
<p>For file URL publishing, the CTS defines two properties in the <code>ts.jte</code>
file, named <code>wsdlRepository1</code> and <code>wsdlRepository2</code>, which specify the
file system directory location to use for publishing final WSDLs that
use file URL publishing.</p>
</div>
<div class="paragraph">
<p>The <code>wsdlRepository1</code> is used for the Vendor Jakarta Platform, Enterprise
Edition Implementation. The <code>wsdlRepository2</code> is used for the CI Jakarta
Platform, Enterprise Edition Implementation, and is only used for CTS
webservices interoperability testing. These directories get created by
the CTS harness at runtime. The default settings in the <code>ts.jte</code> file
will create these directories under:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">wsdlRepository1=&lt;TS_HOME&gt;/tmp/wsdlRepository1
wsdlRepository2=&lt;TS_HOME&gt;/tmp/wsdlRepository2</code></pre>
</div>
</div>
<div class="paragraph">
<p>For file URL publishing, the WSDL tag settings could be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">$TS_HOME/src/com/sun/ts/tests/webservices/wsdlImport/file/Simple1
Webservice Endpoint
&lt;wsdl-publish-location&gt;
file:wsdlRepository1/Simple1File
&lt;/wsdl-publish-location&gt;

Webservice Client Application
&lt;wsdl-override&gt;
file:wsdlRepository1/Simple1File/Simple1FileSvc.wsdl
&lt;/wsdl-override&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the CTS harness substitutes <code>wsdlRepository1</code> with the
setting in the <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file.</p>
</div>
<div class="paragraph">
<p>For <code>http</code> URL publishing, the tag settings might be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">$TS_HOME/src/com/sun/ts/tests/webservices/wsdlImport/http/Simple1
Webservice Endpoint
&lt;wsdl-publish-location&gt;
http://webServerHost.1:webServerPort.1/Simple1Http/ws4ee?WSDL
&lt;/wsdl-publish-location&gt;

Webservice Client Application
&lt;wsdl-override&gt;
http://webServerHost.1:webServerPort.1/Simple1Http/ws4ee?WSDL
&lt;/wsdl-override&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the CTS harness substitutes the
webServerHost.1:webServerPort.1 with the settings in the
<code>&lt;TS_HOME&gt;/bin/ts.jte</code> file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>In the case of interop webservices tests, the CTS harness substitutes
the <code>webServerHost.2:webServerPort.2</code> with the settings in the <code>ts.jte</code>
file. This host and port defines the CI Jakarta Platform, Enterprise
Edition implementation used as the interop test machine. See
<code>tests/interop/webservices</code> for these tests.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEYCO"></a><a id="webservice-endpoint-wsdl-elements"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_22_2_webservice_endpoint_wsdl_elements">5.4.22.2 Webservice Endpoint WSDL Elements</h5>
<div class="paragraph">
<p>The following are the webservice endpoint WSDL elements:</p>
</div>
<div class="paragraph">
<p><a id="GEYMW"></a><a id="setting-endpoint-address"></a></p>
</div>
<div class="paragraph">
<p>5.4.22.2.1 Setting Endpoint Address</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : endpoint-address-uri</code></pre>
</div>
</div>
<div class="paragraph">
<p>The endpoint address URI is used to compose the endpoint address URL
through which the endpoint can be accessed. It is required for Jakarta Enterprise Beans
endpoints and optional for servlet endpoints.</p>
</div>
<div class="paragraph">
<p>The <code>endpoint-address-uri</code> can have an optional leading forward slash
(<code>/</code>). It must be a fixed pattern (no asterisk (<code>*</code>) wildcards).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jakarta Enterprise Beans Example:<br>
For Jakarta Enterprise Beans endpoints, the URI is relative to root of the web server; for
example, if the web server is listening at <code>http://localhost:8000</code>, an
endpoint address URI of <code>google/GoogleSearch</code> would result in an
endpoint address of:<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>http://localhost:8000/google/GoogleSearch</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the first portion of the URI (<code>google</code>) should not conflict
with the context root of any deployed web application.<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;enterprise-beans&gt;
    &lt;module-name&gt;ejb.jar&lt;/module-name&gt;
    &lt;ejb&gt;
      &lt;ejb-name&gt;GoogleEjb&lt;/ejb-name&gt;
      &lt;webservice-endpoint&gt;
        &lt;port-component-name&gt;GoogleSearchPort&lt;/port-component-name&gt;
        &lt;endpoint-address-uri&gt;google/GoogleSearch&lt;/endpoint-address-uri&gt;
      &lt;/webservice-endpoint&gt;
    &lt;/ejb&gt;
&lt;/enterprise-beans&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Servlet Example:<br>
For servlet endpoints, the <code>endpoint-address-uri</code> is only needed if the
servlet does not have a servlet-mapping <code>url-pattern</code> in its <code>web.xml</code>.
Its value is relative to the context root of the servlet&#8217;s web
application.<br></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;web&gt;
    &lt;module-name&gt;web.war&lt;/module-name&gt;
    &lt;context-root&gt;GoogleServletContext&lt;/context-root&gt;
    &lt;servlet&gt;
        &lt;servlet-name&gt;MyGoogleServlet&lt;/servlet-name&gt;
        &lt;webservice-endpoint&gt;
           &lt;port-component-name&gt;GoogleSearchPort&lt;/port-component-name&gt;
           &lt;endpoint-address-uri&gt;/GoogleSearch&lt;/endpoint-address-uri&gt;
         &lt;/webservice-endpoint&gt;
    &lt;/servlet&gt;
&lt;/web&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the target endpoint address would be:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">http://localhost:8000/GoogleServletContext/GoogleSearch</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEYLR"></a><a id="jakarta-enterprise-beans-endpoint-security"></a></p>
</div>
<div class="paragraph">
<p>5.4.22.2.2 Jakarta Enterprise Beans Endpoint Security</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : login-config</code></pre>
</div>
</div>
<div class="paragraph">
<p>This only applies to Jakarta Enterprise Beans endpoints and is optional. It is used to
specify how authentication is performed for Jakarta Enterprise Beans endpoint invocations. It
consists of a single subelement named <code>auth-method</code>. <code>auth-method</code> is
set to <code>BASIC</code> or <code>CLIENT_CERT</code>. The equivalent security for servlet
endpoints is set through the standard web-application security elements.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;ejb&gt;
      &lt;ejb-name&gt;GoogleEjb&lt;/ejb-name&gt;
      &lt;webservice-endpoint&gt;
        &lt;port-component-name&gt;GoogleSearchPort&lt;/port-component-name&gt;
        &lt;endpoint-address-uri&gt;google/GoogleSearch&lt;/endpoint-address-uri&gt;

        &lt;login-config&gt;
           &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
        &lt;/login-config&gt;
      &lt;/webservice-endpoint&gt;
&lt;/ejb&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEYNB"></a><a id="transport-guarantee"></a></p>
</div>
<div class="paragraph">
<p>5.4.22.2.3 Transport Guarantee</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : transport-guarantee</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is an optional setting on <code>webservice-endpoint</code>. The allowable
values are <code>NONE</code>, <code>INTEGRAL</code>, and <code>CONFIDENTIAL</code>. If not specified, the
behavior is equivalent to <code>NONE</code>. The meaning of each option is the same
as is defined in the Security chapter of the Jakarta Servlet 4.0 Specification.
This setting will determine the
scheme and port used to generate the final endpoint address for a web
service endpoint. For <code>NONE</code>, the scheme will be <code>HTTP</code> and port will be
the default HTTP port. For <code>INTEGRAL/CONFIDENTIAL</code>, the scheme will be
<code>HTTPS</code> and the port will be the default HTTPS port.</p>
</div>
<div class="paragraph">
<p><a id="GEYMY"></a><a id="publishing-final-wsdl-during-deployment"></a></p>
</div>
<div class="paragraph">
<p>5.4.22.2.4 Publishing Final WSDL During Deployment</p>
</div>
<div class="ulist">
<ul>
<li>
<p>URL publishing: no extra information required.<br>
The final WSDL document for each webservice endpoint is always published
to a URL having the following syntax:</p>
<div class="ulist">
<ul>
<li>
<p>Jakarta Enterprise Beans endpoints:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;scheme&gt;://&lt;hostname&gt;:&lt;port&gt;/&lt;endpoint_address_uri&gt;?WSDL</code></pre>
</div>
</div>
</li>
<li>
<p>Servlet endpoints:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;scheme&gt;://&lt;hostname&gt;:&lt;port&gt;/&lt;context-root&gt;&lt;url-pattern&gt;?WSDL</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;scheme&gt;://&lt;hostname&gt;:&lt;port&gt;/&lt;context-root&gt;&lt;endpoint_address_uri&gt;?WSDL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the final WSDL document returned from this URL will contain
port entries for all ports within the same service.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>File publishing:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : wsdl-publish-location</code></pre>
</div>
</div>
<div class="paragraph">
<p>To have a copy of the final WSDL written to a file, set this element to
a file URL; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;enterprise-beans&gt;
    &lt;module-name&gt;ejb.jar&lt;/module-name&gt;
    &lt;webservice-description&gt;
        &lt;webservice-description-name&gt;GoogleSearchService
        &lt;/webservice-description-name&gt;
        &lt;wsdl-publish-location&gt;file:/home/user1/GoogleSearch_final.wsdl
        &lt;/wsdl-publish-location&gt;
    &lt;/webservice-description&gt;
&lt;/enterprise-beans&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEYLF"></a><a id="webservice-client-wsdl-elements"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_22_3_webservice_client_wsdl_elements">5.4.22.3 Webservice Client WSDL Elements</h5>
<div class="paragraph">
<p>In the CTS for file publishing, the directory in which to publish the
file WSDL is specified in the <code>&lt;wsdl-publish-location&gt;</code> tag for the
webservice, and the full path of the WSDL file is specified in the
<code>&lt;wsdl-override&gt;</code> tag in the client; for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;wsdl-publish-location&gt;file:/files/wsdls/FileNested1&lt;/wsdl-publish-location&gt;
&lt;wsdl-override&gt;file:/files/wsdls/FileNested1/nestedimportwsdl.wsdl&lt;/wsdl-override&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Jakarta Platform, Enterprise Edition implementation defines the
behavior this way because, for <code>wsdl-publish-location</code>, the App Server
is potentially publishing many documents, not just one. This is because
the main WSDL could have dependencies on relative imports. There is no
requirement that the initial WSDL be located at the top of the
hierarchy, even though that is commonly the case.</p>
</div>
<div class="paragraph">
<p>For example, in an ejb-jar with a Main.wsdl that imports a relative WSDL
at <code>../../Relative.wsdl</code>, the packaging would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">META-INF/wsdl/a/b/Main.wsdl
META-INF/wsdl/Relative.wsdl</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>wsdl-publish-location</code> tells the CTS where to locate the topmost
part of the WSDL content hierarchy. So, given a <code>wsdl-publish-location</code>
of <code>/home/foo/wsdlpublishdir</code>, this location would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">/home/foo/wsdlpublishdir/Relative.wsdl
/home/foo/wsdlpublishdir/a/b/Main.wsdl</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>wsdl-override</code> property still always points to a specific WSDL
document, which in this case would be
<code>/home/foo/wsdlpublishdir/a/b/Main.wsdl</code>.</p>
</div>
<div class="paragraph">
<p><a id="GEYLV"></a><a id="resolving-container-managed-ports"></a></p>
</div>
<div class="paragraph">
<p>5.4.22.3.1 Resolving Container-Managed Ports</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : wsdl-port</code></pre>
</div>
</div>
<div class="paragraph">
<p>Used to resolve the port to which a <code>service-ref</code> Service Endpoint
Interface is mapped. Only required for each <code>port-component-ref</code> in the
<code>service-ref</code> that does not have a <code>port-component-link</code>. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;service-ref&gt;
      &lt;service-ref-name&gt;service/GoogleSearchProxy&lt;/service-ref-name&gt;
      &lt;port-info&gt;
        &lt;service-endpoint-interface&gt;googleclient.GoogleSearchPort
        &lt;/service-endpoint-interface&gt;
        &lt;wsdl-port&gt;
           &lt;namespaceURI&gt;urn:GoogleSearch&lt;/namespaceURI&gt;
           &lt;localpart&gt;GoogleSearchPort&lt;/localpart&gt;
        &lt;/wsdl-port&gt;
   &lt;/port-info&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEYMN"></a><a id="setting-stub-properties"></a></p>
</div>
<div class="paragraph">
<p>5.4.22.3.2 Setting Stub Properties</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : stub-property</code></pre>
</div>
</div>
<div class="paragraph">
<p>These are used to have the container set any of the properties defined
in <code>javax.xml.rpc.Stub</code> on the stub/dynamic proxy object returned to the
application from the Service instance. The property name must match the
<strong>value</strong> of the <code>javax.xml.rpc.Stub</code> property constants. The stub
properties are set per Port within the <code>service-ref</code>. Examples are shown
below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Setting endpoint address:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;service-ref&gt;
    &lt;service-ref-name&gt;service/GoogleSearchProxy&lt;/service-ref-name&gt;
    &lt;port-info&gt;
        &lt;service-endpoint-interface&gt;googleclient.GoogleSearchPort
        &lt;/service-endpoint-interface&gt;
        &lt;wsdl-port&gt;
            &lt;namespaceURI&gt;urn:GoogleSearch&lt;/namespaceURI&gt;
            &lt;localpart&gt;GoogleSearchPort&lt;/localpart&gt;
        &lt;/wsdl-port&gt;
        &lt;stub-property&gt;
            &lt;name&gt;javax.xml.rpc.service.endpoint.address&lt;/name&gt;
            &lt;value&gt;http://localhost:8000/google/GoogleSearch&lt;/value&gt;
        &lt;/stub-property&gt;
    &lt;/port-info&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Setting Basic Auth properties:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;service-ref&gt;
    &lt;service-ref-name&gt;service/GoogleSearchProxy&lt;/service-ref-name&gt;
    &lt;port-info&gt;
        &lt;service-endpoint-interface&gt;googleclient.GoogleSearchPort
        &lt;/service-endpoint-interface&gt;
        &lt;wsdl-port&gt;
            &lt;namespaceURI&gt;urn:GoogleSearch&lt;/namespaceURI&gt;
            &lt;localpart&gt;GoogleSearchPort&lt;/localpart&gt;
        &lt;/wsdl-port&gt;
        &lt;stub-property&gt;
            &lt;name&gt;javax.xml.rpc.security.auth.username&lt;/name&gt;
            &lt;value&gt;javaee&lt;/value&gt;
        &lt;/stub-property&gt;
        &lt;stub-property&gt;
            &lt;name&gt;javax.xml.rpc.security.auth.password&lt;/name&gt;
            &lt;value&gt;javaee&lt;/value&gt;
        &lt;/stub-property&gt;
    &lt;/port-info&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>Setting Logging property (Implementation-specific):<br>
Name: <code>com.sun.enterprise.webservice.client.transport.log</code><br>
Value: a <code>file</code> URL<br>
This is useful for debugging. When set, all soap/http requests and
responses made through the associated stub will be logged to a file.</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;module-name&gt;appclient.jar&lt;/module-name&gt;
&lt;service-ref&gt;
    &lt;service-ref-name&gt;service/GoogleSearch&lt;/service-ref-name&gt;
    &lt;port-info&gt;
        &lt;service-endpoint-interface&gt;google.GoogleSearchPort
        &lt;/service-endpoint-interface&gt;
        &lt;wsdl-port&gt;
            &lt;namespaceURI&gt;urn:GoogleSearch&lt;/namespaceURI&gt;
            &lt;localpart&gt;GoogleSearchPort&lt;/localpart&gt;
        &lt;/wsdl-port&gt;
        &lt;stub-property&gt;
            &lt;name&gt;com.sun.enterprise.webservice.client.transport.log&lt;/name&gt;
            &lt;value&gt;file:/tmp/jaxrpc.log&lt;/value&gt;
        &lt;/stub-property&gt;
    &lt;/port-info&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEYMB"></a><a id="setting-call-properties"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_22_3_3_setting_call_properties">5.4.22.3.3 Setting Call Properties</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : call-property</code></pre>
</div>
</div>
<div class="paragraph">
<p>Call properties are set on <code>service-ref</code> for <code>Call</code> objects returned
from <code>javax.xml.rpc.Service.createCall()</code>. This is the only kind of
<code>Call</code> object that is not tied to a port.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;service-ref&gt;
      &lt;service-ref-name&gt;service/GoogleSearch&lt;/service-ref-name&gt;
      &lt;call-property&gt;
        &lt;name&gt;javax.xml.rpc.security.auth.username&lt;/name&gt;
        &lt;value&gt;javaee&lt;/value&gt;
      &lt;/call-property&gt;
      &lt;call-property&gt;
        &lt;name&gt;javax.xml.rpc.security.auth.password&lt;/name&gt;
        &lt;value&gt;javaee&lt;/value&gt;
      &lt;/call-property&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Call properties are set within <code>port-info</code> for all other
<code>javax.xml.rpc.Service</code> methods that return <code>Call</code> objects.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;module-name&gt;appclient.jar&lt;/module-name&gt;
      &lt;service-ref&gt;
         &lt;service-ref-name&gt;service/GoogleSearch&lt;/service-ref-name&gt;
         &lt;port-info&gt;
           &lt;wsdl-port&gt;
              &lt;namespaceURI&gt;urn:GoogleSearch&lt;/namespaceURI&gt;
              &lt;localpart&gt;GoogleSearchPort&lt;/localpart&gt;
           &lt;/wsdl-port&gt;
           &lt;call-property&gt;
             &lt;name&gt;javax.xml.rpc.security.auth.username&lt;/name&gt;
             &lt;value&gt;javaee&lt;/value&gt;
           &lt;/call-property&gt;
           &lt;call-property&gt;
             &lt;name&gt;javax.xml.rpc.security.auth.password&lt;/name&gt;
             &lt;value&gt;javaee&lt;/value&gt;
           &lt;/call-property&gt;
         &lt;/port-info&gt;
      &lt;/service-ref&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The allowable properties are defined in the javadoc for
<code>javax.xml.rpc.Call</code>.</p>
</div>
<div class="paragraph">
<p><a id="GEYOG"></a><a id="overriding-wsdl"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_22_3_4_overriding_wsdl">5.4.22.3.4 Overriding WSDL</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">element : wsdl-override</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>wsdl-override</code> element forces the deployment process to use a
different WSDL than the one associated with a <code>service-ref</code> in the
standard deployment module. This element is optional if the
<code>service-ref</code> WSDL is full WSDL, and is required if partial WSDL. In all
cases, it must point to a valid URL of a full WSDL document. Some
examples are shown below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To use the final WSDL generated upon deployment of the EJB endpoint
shown above:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;service-ref&gt;
      &lt;service-ref-name&gt;service/GoogleSearch&lt;/service-ref-name&gt;
      &lt;wsdl-override&gt;http://localhost:8000/google/GoogleSearch?WSDL
      &lt;/wsdl-override&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
</li>
<li>
<p>An alternate way to do the same thing by means of a file URL that
matches a webservice&#8217;s <code>wsdl-publish-location</code> could be:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">&lt;service-ref&gt;
      &lt;service-ref-name&gt;service/GoogleSearch&lt;/service-ref-name&gt;
      &lt;wsdl-override&gt;file:/home/user1/GoogleSearch_final.wsdl
      &lt;/wsdl-override&gt;
&lt;/service-ref&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="CEGCHDEA"></a><a id="jakarta-security-api-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_23_jakarta_security_api_test_setup">5.4.23 Jakarta Security API Test Setup</h4>
<div class="paragraph">
<p>Complete the following steps before you run the Jakarta Security API tests:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set the following properties in the ts.jte file:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>An LDAP server is required in Jakarta Security API testing. You could either use
an already existing external LDAP server or use CTS script to install an
internal LDAP server.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Choose one of these two options to make an LDAP server ready for
testing:</p>
</div>
</li>
<li>
<p>Use internal LDAP server - Unbounded (Recommended, and would be
installed by default.)</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure the ldap.server property is unbounded.</p>
</li>
<li>
<p>Ensure the path of ldap.ldif.file is correct.</p>
</li>
<li>
<p>Ensure the port 11389 is not occupied. Kill any related process
using port 11389.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Parts of ts.jte:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ldap.server=unboundid</code></p>
</li>
<li>
<p><code>ldap.install.server=true</code></p>
</li>
<li>
<p><code>ldap.ldif.file=$\{ts.home}/bin/ldap.ldif</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use external LDAP server.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure the port of LDAP server is 11389.</p>
</li>
<li>
<p>Update ldap.install.server property as false since CTS script need
not install LDAP server.</p>
</li>
<li>
<p>Import ldap.ldif file into Ldap server. You can get ldap.ldif from
<code>&lt;TS_HOME&gt;/install/jakartaee/bin/ldap.ldif</code>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Part of ts.jte - ldap.install.server=false</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Configure the VI environment using these commands to run the
Jakarta Security API test (including Derby, internal Ldap server which are
required by Jakarta Security 1.0):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>cd &lt;TS_HOME&gt;/bin</p>
</li>
<li>
<p>ant config.vi</p>
</li>
<li>
<p>Start your database.</p>
</li>
<li>
<p>ant init.ldap</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you use the external LDAP server, do not run the command ant
init.ldap.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><a id="GEYNX"></a><a id="signature-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_24_signature_test_setup">5.4.24 Signature Test Setup</h4>
<div class="paragraph">
<p>The signature test setup includes the following:</p>
</div>
<div class="paragraph">
<p><a id="GEYPN"></a><a id="sigtestclasspath-property"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_24_1_sigtestclasspath_property">5.4.24.1 sigTestClasspath Property</h5>
<div class="paragraph">
<p>Set the <code>sigTestClasspath</code> property in the <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file
to include a <code>CLASSPATH</code> containing the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">sigTestClasspath=jar_to_test:jars_used_by_yours</code></pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>``jar_to_test``: The JAR file you are validating when running the
signature tests; when running against the Jakarta Platform, Enterprise
Edition CI, Eclipse GlassFish 5.1, set to <code>javaee.jar</code></p>
</li>
<li>
<p>``jars_used_by_yours``: The JAR file or files that are used or referenced
by your JAR file; must include any classes that might be extended or
implemented by the classes in your jar_to_test; include <code>rt.jar</code> when
running against the Jakarta Platform, Enterprise Edition CI</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEYOS"></a><a id="additional-signature-test-information"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_24_2_additional_signature_test_information">5.4.24.2 Additional Signature Test Information</h5>
<div class="paragraph">
<p>The Jakarta EE 8 CTS signature tests perform verifications in two different
modes: static and reflection. The test results list which signature
tests pass or fail, and the mode (static or reflection) for that test.
As a troubleshooting aid when failures occur, consider the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All static mode tests fail:<br>
The likely cause is that the <code>sigTestClasspath</code> needs modification. When
running on Windows, be sure to use semicolons (<code>;</code>) for <code>CLASSPATH</code>
separators.</p>
</li>
<li>
<p>For all other signature test failures:<br>
Check the report output from the test to determine which tests failed
and why.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Refer to <a href="debug.html#GBFUV">Chapter 8, "Debugging Test Problems"</a> for
additional debugging information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GJLGQ"></a><a id="backend-database-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_25_backend_database_setup">5.4.25 Backend Database Setup</h4>
<div class="paragraph">
<p>The following sections address special backend database setup
considerations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#GJLIB">Setup Considerations for MySQL</a></p>
</li>
<li>
<p><a href="#GJLHU">Setup Considerations for MS SQL Server</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GJLIB"></a><a id="setup-considerations-for-mysql"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_25_1_setup_considerations_for_mysql">5.4.25.1 Setup Considerations for MySQL</h5>
<div class="paragraph">
<p>The Jakarta Persistence API (formerly JPA) tests require delimited identifiers for
the native query tests. If you are using delimited identifiers on MySQL,
modify the <code>sql-mode</code> setting in the <code>my.cnf</code> file to set the
ANSI_QUOTES option. After setting this option, reboot the MySQL server.
Set the option as shown in this example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">sql-mode="STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,ANSI_QUOTES"</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GJLHU"></a><a id="setup-considerations-for-ms-sql-server"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_25_2_setup_considerations_for_ms_sql_server">5.4.25.2 Setup Considerations for MS SQL Server</h5>
<div class="paragraph">
<p>If your database already exists and if you use a case-sensitive
collation on MS SQL Server, execute the following command to modify the
database and avert errors caused by case-sensitive collation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">ALTER DATABASE ctsdb
COLLATE Latin1_General_CS_AS ;</code></pre>
</div>
</div>
<div class="paragraph">
<p><a id="GEXQP"></a><a id="deployment-test-setup"></a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_26_deployment_test_setup">5.4.26 Deployment Test Setup</h4>
<div class="paragraph">
<p>Ensure that the following properties in the <code>ts.jte</code> file have been set:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>deployManagerJarFile.1</code> property to a JAR file that contains manifest
entries according to the Jakarta Platform, Enterprise Edition Jakarta Deployment API
1.2 Specification</p>
</li>
<li>
<p><code>deployManageruri.1</code> property to a URI to connect to</p>
</li>
<li>
<p><code>deployManageruname.1</code> and <code>deployManagerpasswd.1</code> properties to the
user name and password that are used when connecting to a deployment
manager, if needed</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>You need to generate your own deployment plan for each module type,
using the deployment tool that comes with your Jakarta Platform, Enterprise
Edition server.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a id="GEXPU"></a><a id="jakarta-xml-registries-test-setup"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_4_27_jakarta_xml_registries_test_setup">5.4.27 Jakarta XML Registries Test Setup</h4>
<div class="paragraph">
<p>You will need a Registry to run the Jakarta XML Registries tests. The <em>Java Web Services
Developers Pack 1.3</em> contains an implementation of a UDDI version 2
business registry. You can find the <em>Java Web Services Developers Pack</em> at
<code>http://www.oracle.com/technetwork/java/javasebusiness/downloads/java-archive-downloads-jwsdp-419428.html</code>.
Refer to the installation instructions that accompany the webservices
software for additional information.</p>
</div>
<div class="paragraph">
<p>The Jakarta XML Registries test suite assumes you are using an internal registry (inside a
firewall). If you want to use a public registry outside a firewall, you
will need to make some updates to the <code>ts.jte</code> file in the
<code>testExecuteAppClient</code> section to set up proxy information.</p>
</div>
<div class="paragraph">
<p><a id="GEXPG"></a><a id="example-jakarta-xml-registries-ts.jte-property-settings"></a></p>
</div>
<div class="sect4">
<h5 id="_5_4_27_1_example_jakarta_xml_registries_ts_jte_property_settings">5.4.27.1 Example Jakarta XML Registries ts.jte Property Settings</h5>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">http.proxyHost=myProxy.myCompany.com
http.proxyPort=8080
https.proxyHost=myProxy.myCompany.com
https.proxyPort=8080
command.testExecuteAppClient= \
com.sun.ts.lib.harness.ExecTSTestCmd DISPLAY=${ts.display} HOME="${user.home}" \
LD_LIBRARY_PATH=${javaee.home}/lib \
windir=${windir} \
SYSTEMROOT=${SYSTEMROOT} \
PATH="${javaee.home}/nativelib" \
TZ=${tz} \
${JAVA_HOME}/bin/java \
-Dorg.omg.CORBA.ORBInitialHost=${orb.host} \
-Djava.security.policy=${javaee.home}/lib/appclient/client.policy \
-Dcts.tmp=$harness.temp.directory \
-Dorg.omg.CORBA.ORBInitialPort=${orb.port} \
-Djava.security.auth.login.config=${javaee.home}/lib/appclient/appclientlogin.conf \
-Djava.protocol.handler.pkgs=javax.net.ssl \
-Dcom.sun.enterprise.home=${javaee.home} \
-Djavax.net.ssl.keyStore=${ts.home}/bin/certificates/clientcert.jks \
-Djavax.net.ssl.keyStorePassword=changeit \
-Dcom.sun.aas.installRoot=${javaee.home} \
-Dcom.sun.aas.imqLib=${javaee.home}/imq/lib \
-Djava.util.logging.manager=com.sun.enterprise.server.logging.ACCLogManager \
-Djavax.net.ssl.trustStore=${s1as.domain}/config/cacerts.jks \
-Djava.endorsed.dirs=${s1as.java.endorsed.dirs} \
-Dstartup.login=false \
-Dhttp.proxyHost=${http.proxyHost} \
-Dhttp.proxyPort=${http.proxyPort} \
-Dhttps.proxyHost=${https.proxyHost} \
-Dhttps.proxyPort=${https.proxyPort} \
-Ddeliverable.class=${deliverable.class} -classpath ${ts.run.classpath} \
com.sun.enterprise.appclient.Main $testExecuteArgs -configxml ${s1as.domain}/config/sun-acc.xml</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above settings cover the appclient portion of the testing. You will
also need to update the proxy information for the server. For the CI Eclipse GlassFish 5.1,
you will need to add this to the <code>jvm-options</code> in the <code>domain.xml</code> file.
You can also use the CTS <code>config.vi</code> script to update <code>domain.xml</code>
instead of directly editing it. To use the <code>config.vi</code> script, add the
proxy to <code>s1as.jvm.options</code> in the <code>ts.jte</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">s1as.jvm.options=-Dhttp.proxyHost=${http.proxyHost}:
-Dhttp.proxyPort=${http.proxyPort}:
-Dhttps.proxyHost=${https.proxyHost}:
-Dhttps.proxyPort=${https.proxyPort}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this is only needed for Jakarta Registries when using an external registry.
You should not add proxy info when running the rest of the CTS test
suite.</p>
</div>
<div class="paragraph">
<p><a id="GEXPI"></a><a id="jakarta-registries-ts.jte-properties"></a></p>
</div>
</div>
<div class="sect4">
<h5 id="_5_4_27_2_jakarta_registries_ts_jte_properties">5.4.27.2 Jakarta Registries ts.jte Properties</h5>
<div class="paragraph">
<p>For Jakarta Registries testing, make sure the following properties have been set in
the <code>&lt;TS_HOME&gt;/bin/ts.jte</code> file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>authenticationMethod</code>: Authentication method for the Jakarta Registries provider;
UDDI_GET_AUTHTOKEN is the AuthToken protocol defined by [UDDI_API2]</p>
</li>
<li>
<p><code>registryURL</code>: Standard connection property for publishing. for the
RegistryServer, the UDDI Registry that comes with the <em>Java Web Services
Developers Pack</em>: <code>registryURL = http://localhost:8080/RegistryServer/</code></p>
</li>
<li>
<p><code>queryManagerURL</code>: Standard connection property for querying. for the
RegistryServer, the UDDI Registry that comes with the <em>Java Web Services
Developers Pack</em>:
<code>queryManagerURL = http://localhost:8080/RegistryServer/</code></p>
</li>
<li>
<p><code>jaxrPassword</code>: Used for setting connection credentials; this must be
set up in the UDDI registry</p>
</li>
<li>
<p><code>jaxrUser</code>: Used for setting connection credentials; this must be set
up in the UDDI registry</p>
</li>
<li>
<p><code>jaxrUser2</code>, <code>jaxrPassword2</code>: Second account for Association tests<br>
For the <code>RegistryServer</code> you can use the predefined username and
passwords. These would be set as follows:</p>
<div class="ulist">
<ul>
<li>
<p><code>jaxrUser=testuser</code></p>
</li>
<li>
<p><code>jaxrPassword=testuser</code></p>
</li>
<li>
<p><code>jaxrUser2=jaxr-sqe</code></p>
</li>
<li>
<p><code>jaxrPassword2=jaxrsqe</code><br>
If using digital certificates set to <code>= ""</code> instead.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>jaxrSecurityCredentialType</code>: Tells CTS whether to use
username/password or digital certificates for Jakarta Registries credentials:</p>
<div class="ulist">
<ul>
<li>
<p><code>0</code>: Username/password</p>
</li>
<li>
<p><code>1</code>: Digital certificates</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>jaxrAlias</code>: Identifies the entry in the keystore for this user.</p>
</li>
<li>
<p><code>jaxrAlias2</code>: Identifies the entry in the keystore for the second user</p>
</li>
<li>
<p><code>jaxrAliasPassword</code>: Identifies the password in the keystore for this
user.</p>
</li>
<li>
<p><code>jaxrAlias2Password</code>: Identifies the password in the keystore for the
second user</p>
</li>
<li>
<p><code>jaxrWebContext</code>: Context root for jaxr html tests pages</p>
</li>
<li>
<p><code>jaxrConnectionFactoryLookup</code>: Preferred way for a client to lookup a
Jakarta Registries ConnectionFactory is to use JNDI; an alternate method is to use the
<code>newInstance</code> static method on the <code>ConnectionFactory</code></p>
<div class="ulist">
<ul>
<li>
<p><code>0</code> = use JNDI lookup</p>
</li>
<li>
<p><code>1</code> = use <code>newInstance</code> method.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>jaxrJNDIResource</code>: <code>JAXR</code> <code>ConnectionFactoryReference</code> if JNDI lookup
is being used; for example <code>java:comp/env/eis/JAXR</code>; if not using JNDI
lookup set to <code>""</code>.</p>
</li>
<li>
<p><code>providerCapabilityLevel</code>: Provider must set this to the supported
capability level <code>0</code> or <code>1</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEYPB"></a><a id="using-the-javatest-harness-configuration-gui"></a></p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_5_5_using_the_javatest_harness_configuration_gui">5.5 Using the JavaTest Harness Configuration GUI</h3>
<div class="paragraph">
<p>You can use the JavaTest harness GUI to modify general test settings and
to quickly get started with the default CTS test environment. After
familiarizing yourself with these basic configuration settings, you will
probably want to continue with the instructions in <a href="#GEXPP">Modifying
Environment Settings for Specific Technology Tests</a>.</p>
</div>
<div class="paragraph">
<p><a id="GEYNM"></a><a id="basic-configuration-overview"></a></p>
</div>
<div class="sect3">
<h4 id="_5_5_1_basic_configuration_overview">5.5.1 Basic Configuration Overview</h4>
<div class="paragraph">
<p>In order for the JavaTest harness to execute the test suite, it requires
information about how your computing environment is configured.</p>
</div>
<div class="paragraph">
<p>The JavaTest harness requires two types of configuration information:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Test environment: This is data used by the tests. For example, the
path to the Java runtime, how to start the product being tested, network
resources, and other information required by the tests in order to run.
This information does not change frequently and usually stays constant
from test run to test run.</p>
</li>
<li>
<p>Test parameters: This is information used by the JavaTest harness to
run the tests. Test parameters are values used by the JavaTest harness
that determine which tests in the test suite are run, how the tests
should be run, and where the test reports are stored. This information
often changes from test run to test run.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When you execute the JavaTest harness software for the first time, the
JavaTest harness displays a Welcome dialog box that guides you through
the initial startup configuration.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If it is able to open a test suite, the JavaTest harness displays a
Welcome to JavaTest dialog box that guides you through the process of
either opening an existing work directory or creating a new work
directory as described in the JavaTest online help.</p>
</li>
<li>
<p>If the JavaTest harness is unable to open a test suite, it displays a
Welcome to JavaTest dialog box that guides you through the process of
opening both a test suite and a work directory as described in the
JavaTest documentation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Once the JavaTest harness GUI is displayed, whenever you choose Run
Tests and then Start to begin a test run, the JavaTest harness
determines whether all of the required configuration information has
been supplied:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the test environment and parameters have been completely
configured, the test run starts immediately.</p>
</li>
<li>
<p>If any required configuration information is missing, the
configuration editor displays a series of questions asking you the
necessary information. This is called the configuration interview. When
you have entered the configuration data, you are asked if you wish to
proceed with running the test.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a id="GEYOD"></a><a id="the-configuration-interview"></a></p>
</div>
</div>
<div class="sect3">
<h4 id="_5_5_2_the_configuration_interview">5.5.2 The Configuration Interview</h4>
<div class="paragraph">
<p>To configure the JavaTest harness to run the Jakarta EE 8 CTS tests,
complete the following steps. Note that you only need to complete these
steps the first time you start the JavaTest harness. After you complete
these steps, you can either run all or a subset of the tests, as
described in <a href="using.html#GBFWO">Chapter 7, "Executing Tests"</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Change to the <code>&lt;TS_HOME&gt;/bin</code> directory and start the JavaTest test
harness:</p>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">cd &lt;TS_HOME&gt;/bin
ant gui</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Welcome screen displays.</p>
</div>
</li>
<li>
<p>Click <strong>File</strong>, then click <strong>Create Work Directory</strong> to create a new work
directory.<br>
If you already have a working directory you want to use, click <strong>File</strong>,
then click <strong>Open Work Directory</strong> instead.<br>
At this point, the JavaTest harness is preconfigured to run the basic
CTS tests.</p>
</li>
<li>
<p>If you want to run the test suite at this time using your current
configuration settings, select <strong>Run Tests</strong> from the main menu, then select
<strong>Start</strong>.<br>
The default tests are executed with the default configuration settings.<br>
If you do not want to run the test suite at this time, continue with the
steps below to modify your test configuration.</p>
</li>
<li>
<p>Select <strong>Configure</strong> from the main menu, then select <strong>Edit Configuration</strong>.<br>
The <strong>Configuration Welcome</strong> screen displays.</p>
</li>
<li>
<p>Click <strong>Next</strong> (right arrow).<br>
You are prompted to specify one or more configuration files that contain
information about your test environment. By default, this file is
<code>&lt;TS_HOME&gt;/bin/ts.jte</code>.</p>
</li>
<li>
<p>Accept the default configuration file and click <strong>Next</strong>.<br>
You are prompted to specify a test environment.</p>
</li>
<li>
<p>Select either <code>ts_unix</code> or <code>ts_win32</code>, and then click <strong>Next</strong>.<br>
Choose <code>ts_unix</code> if you are running the tests in a Unix or Linux
environment; choose <code>ts_win32</code> if you are running the tests under
Windows.<br>
After making your selection and clicking <strong>Next</strong>, you are prompted to
specify whether you want to run all or a subset of the test suite.</p>
</li>
<li>
<p>Specify whether you want to run all or a subset of the tests, and
then click <strong>Next</strong>.<br>
Select <strong>Yes</strong> to run a subset of the tests; select <strong>No</strong> to run all tests.<br>
If you select <strong>Yes</strong>, proceed to the next step. If you select <strong>No</strong>, skip to
Step 10.</p>
</li>
<li>
<p>Select the tests you want to run from the displayed test tree, and
then click <strong>Next</strong>.<br>
You can select entire branches of the test tree, or use <code>Ctrl+Click</code> or
<code>Shift+Click</code> to select multiple tests or ranges of tests, respectively.</p>
</li>
<li>
<p>Specify whether you want to use an exclude list, and then click
<strong>Next</strong>.<br>
Select Yes to use an exclude list; select No to not use an exclude list.<br>
If you select <strong>Yes</strong>, proceed to the next step. If you select <strong>No</strong>, skip to
Step 13.</p>
</li>
<li>
<p>Specify the exclude list you want to use, and then click <strong>Next</strong>.<br>
Select <code>initial</code> to use the default list; select <code>custom</code> to use a
custom list.<br>
If you select <code>custom</code>, proceed to the next step. If you select
<code>initial</code>, skip to Step 13.</p>
</li>
<li>
<p>Specify the custom exclude list file to use, and then click <strong>Next</strong>.</p>
</li>
<li>
<p>Click <strong>Done</strong> to accept and save your configuration settings.<br>
You are prompted to specify the location in which you want to save your
configuration settings.</p>
</li>
<li>
<p>Specify the file in which you want to save your configuration
settings, and then click <strong>Save File</strong>.<br>
You are returned to the JavaTest main window.</p>
</li>
<li>
<p>If you want to run the test suite at this time using your current
configuration settings, select Run Tests from the main menu, then select
<strong>Start</strong>.<br>
The default tests are executed with the settings you specified.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>

<hr />

<table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
	<colgroup>
		<col width="12%"/>
		<col width="12%"/>
		<col width="*"/>
	</colgroup>
	<tr>		
		<td align="left">
		<a href="install.html">
			<span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Previous</span>
		</a>
		</td>

		<td align="left">
		<a href="webprofileconfig.html">
			<span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Next</span>
		</a>
		</td>

		<td align="right">
		<a href="toc.html">
			<span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
			<span style="position:relative;top:-2px;">Contents</span>
		</a>
		</td>
	</tr>
</table>

<span id="copyright">
		<img src="img/eclipse_foundation_logo_tiny.png" height="20px" alt="Eclipse Foundation Logo" align="top"/>&nbsp;			
		<span >Copyright&nbsp;&copy;&nbsp;2018,&nbsp;Oracle&nbsp;and/or&nbsp;its&nbsp;affiliates.&nbsp;All&nbsp;rights&nbsp;reserved.</span>
</span>

</body>
</html>
